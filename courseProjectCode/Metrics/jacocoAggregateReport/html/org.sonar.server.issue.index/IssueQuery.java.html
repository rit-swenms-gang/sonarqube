<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>IssueQuery.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">sonarqube</a> &gt; <a href="index.source.html" class="el_package">org.sonar.server.issue.index</a> &gt; <span class="el_source">IssueQuery.java</span></div><h1>IssueQuery.java</h1><pre class="source lang-java linenums">/*
 * SonarQube
 * Copyright (C) 2009-2025 SonarSource SA
 * mailto:info AT sonarsource DOT com
 *
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 3 of the License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with this program; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
 */
package org.sonar.server.issue.index;

import java.time.ZoneId;
import java.util.Collection;
import java.util.Collections;
import java.util.Date;
import java.util.Map;
import java.util.Optional;
import java.util.Set;
import javax.annotation.CheckForNull;
import javax.annotation.Nullable;
import org.apache.commons.lang3.builder.ReflectionToStringBuilder;
import org.sonar.db.rule.RuleDto;

/**
 * @since 3.6
 */
public class IssueQuery {

  public static final String SORT_BY_CREATION_DATE = &quot;CREATION_DATE&quot;;
  public static final String SORT_BY_UPDATE_DATE = &quot;UPDATE_DATE&quot;;
  public static final String SORT_BY_CLOSE_DATE = &quot;CLOSE_DATE&quot;;
  public static final String SORT_BY_SEVERITY = &quot;SEVERITY&quot;;
  public static final String SORT_BY_STATUS = &quot;STATUS&quot;;

  /**
   * Sort by project, file path then line id
   */
  public static final String SORT_BY_FILE_LINE = &quot;FILE_LINE&quot;;
  /**
   * Sort hotspots by vulnerabilityProbability, sqSecurityCategory, project, file path then line id
   */
  public static final String SORT_HOTSPOTS = &quot;HOTSPOTS&quot;;

<span class="fc" id="L54">  public static final Set&lt;String&gt; SORTS = Set.of(SORT_BY_CREATION_DATE, SORT_BY_UPDATE_DATE, SORT_BY_CLOSE_DATE, SORT_BY_SEVERITY,</span>
    SORT_BY_STATUS, SORT_BY_FILE_LINE, SORT_HOTSPOTS);

  private final Collection&lt;String&gt; issueKeys;
  private final Collection&lt;String&gt; severities;
  private final Collection&lt;String&gt; impactSeverities;
  private final Collection&lt;String&gt; impactSoftwareQualities;
  private final Collection&lt;String&gt; statuses;
  private final Collection&lt;String&gt; issueStatuses;
  private final Collection&lt;String&gt; resolutions;
  private final Collection&lt;String&gt; components;
  private final Collection&lt;String&gt; projects;
  private final Collection&lt;String&gt; directories;
  private final Collection&lt;String&gt; files;
  private final Collection&lt;String&gt; views;
  private final Collection&lt;RuleDto&gt; rules;
  private final Collection&lt;String&gt; ruleUuids;
  private final Collection&lt;String&gt; assignees;
  private final Collection&lt;String&gt; authors;
  private final Collection&lt;String&gt; scopes;
  private final Collection&lt;String&gt; languages;
  private final Collection&lt;String&gt; tags;
  private final Collection&lt;String&gt; types;
  private final Collection&lt;String&gt; owaspMobileTop10For2024;
  private final Collection&lt;String&gt; owaspTop10;
  private final Collection&lt;String&gt; pciDss32;
  private final Collection&lt;String&gt; pciDss40;
  private final Collection&lt;String&gt; owaspAsvs40;
  private final Integer owaspAsvsLevel;
  private final Collection&lt;String&gt; owaspTop10For2021;
  private final Collection&lt;String&gt; stigAsdV5R3;
  private final Collection&lt;String&gt; casa;
  private final Collection&lt;String&gt; sansTop25;
  private final Collection&lt;String&gt; cwe;
  private final Collection&lt;String&gt; sonarsourceSecurity;
  private final Map&lt;String, PeriodStart&gt; createdAfterByProjectUuids;
  private final Boolean onComponentOnly;
  private final Boolean assigned;
  private final Boolean resolved;
  private final Boolean prioritizedRule;
  private final Boolean fromSonarQubeUpdate;
  private final Date createdAt;
  private final PeriodStart createdAfter;
  private final Date createdBefore;
  private final String sort;
  private final Boolean asc;
  private final String facetMode;
  private final String branchUuid;
  private final Boolean mainBranch;
  private final ZoneId timeZone;
  private final Boolean newCodeOnReference;
  private final Collection&lt;String&gt; newCodeOnReferenceByProjectUuids;
  private final Collection&lt;String&gt; codeVariants;
  private final Collection&lt;String&gt; cleanCodeAttributesCategories;

<span class="fc" id="L109">  private IssueQuery(Builder builder) {</span>
<span class="fc" id="L110">    this.issueKeys = nullableDefaultCollection(builder.issueKeys);</span>
<span class="fc" id="L111">    this.severities = defaultCollection(builder.severities);</span>
<span class="fc" id="L112">    this.impactSeverities = defaultCollection(builder.impactSeverities);</span>
<span class="fc" id="L113">    this.impactSoftwareQualities = defaultCollection(builder.impactSoftwareQualities);</span>
<span class="fc" id="L114">    this.statuses = defaultCollection(builder.statuses);</span>
<span class="fc" id="L115">    this.resolutions = defaultCollection(builder.resolutions);</span>
<span class="fc" id="L116">    this.issueStatuses = defaultCollection(builder.issueStatuses);</span>
<span class="fc" id="L117">    this.components = defaultCollection(builder.components);</span>
<span class="fc" id="L118">    this.projects = defaultCollection(builder.projects);</span>
<span class="fc" id="L119">    this.directories = defaultCollection(builder.directories);</span>
<span class="fc" id="L120">    this.files = defaultCollection(builder.files);</span>
<span class="fc" id="L121">    this.views = defaultCollection(builder.views);</span>
<span class="fc" id="L122">    this.rules = defaultCollection(builder.rules);</span>
<span class="fc" id="L123">    this.ruleUuids = defaultCollection(builder.ruleUuids);</span>
<span class="fc" id="L124">    this.assignees = defaultCollection(builder.assigneeUuids);</span>
<span class="fc" id="L125">    this.authors = defaultCollection(builder.authors);</span>
<span class="fc" id="L126">    this.scopes = defaultCollection(builder.scopes);</span>
<span class="fc" id="L127">    this.languages = defaultCollection(builder.languages);</span>
<span class="fc" id="L128">    this.tags = defaultCollection(builder.tags);</span>
<span class="fc" id="L129">    this.types = defaultCollection(builder.types);</span>
<span class="fc" id="L130">    this.pciDss32 = defaultCollection(builder.pciDss32);</span>
<span class="fc" id="L131">    this.pciDss40 = defaultCollection(builder.pciDss40);</span>
<span class="fc" id="L132">    this.owaspAsvs40 = defaultCollection(builder.owaspAsvs40);</span>
<span class="fc" id="L133">    this.owaspAsvsLevel = builder.owaspAsvsLevel;</span>
<span class="fc" id="L134">    this.owaspMobileTop10For2024 = defaultCollection(builder.owaspMobileTop10For2024);</span>
<span class="fc" id="L135">    this.owaspTop10 = defaultCollection(builder.owaspTop10);</span>
<span class="fc" id="L136">    this.owaspTop10For2021 = defaultCollection(builder.owaspTop10For2021);</span>
<span class="fc" id="L137">    this.stigAsdV5R3 = defaultCollection(builder.stigAsdV5R3);</span>
<span class="fc" id="L138">    this.casa = defaultCollection(builder.casa);</span>
<span class="fc" id="L139">    this.sansTop25 = defaultCollection(builder.sansTop25);</span>
<span class="fc" id="L140">    this.cwe = defaultCollection(builder.cwe);</span>
<span class="fc" id="L141">    this.sonarsourceSecurity = defaultCollection(builder.sonarsourceSecurity);</span>
<span class="fc" id="L142">    this.createdAfterByProjectUuids = defaultMap(builder.createdAfterByProjectUuids);</span>
<span class="fc" id="L143">    this.onComponentOnly = builder.onComponentOnly;</span>
<span class="fc" id="L144">    this.assigned = builder.assigned;</span>
<span class="fc" id="L145">    this.resolved = builder.resolved;</span>
<span class="fc" id="L146">    this.prioritizedRule = builder.prioritizedRule;</span>
<span class="fc" id="L147">    this.fromSonarQubeUpdate = builder.fromSonarQubeUpdate;</span>
<span class="fc" id="L148">    this.createdAt = builder.createdAt;</span>
<span class="fc" id="L149">    this.createdAfter = builder.createdAfter;</span>
<span class="fc" id="L150">    this.createdBefore = builder.createdBefore;</span>
<span class="fc" id="L151">    this.sort = builder.sort;</span>
<span class="fc" id="L152">    this.asc = builder.asc;</span>
<span class="fc" id="L153">    this.facetMode = builder.facetMode;</span>
<span class="fc" id="L154">    this.branchUuid = builder.branchUuid;</span>
<span class="fc" id="L155">    this.mainBranch = builder.mainBranch;</span>
<span class="fc" id="L156">    this.timeZone = builder.timeZone;</span>
<span class="fc" id="L157">    this.newCodeOnReference = builder.newCodeOnReference;</span>
<span class="fc" id="L158">    this.newCodeOnReferenceByProjectUuids = defaultCollection(builder.newCodeOnReferenceByProjectUuids);</span>
<span class="fc" id="L159">    this.codeVariants = defaultCollection(builder.codeVariants);</span>
<span class="fc" id="L160">    this.cleanCodeAttributesCategories = defaultCollection(builder.cleanCodeAttributesCategories);</span>
<span class="fc" id="L161">  }</span>

  public Collection&lt;String&gt; issueKeys() {
<span class="fc" id="L164">    return issueKeys;</span>
  }

  public Collection&lt;String&gt; severities() {
<span class="fc" id="L168">    return severities;</span>
  }

  public Collection&lt;String&gt; impactSeverities() {
<span class="fc" id="L172">    return impactSeverities;</span>
  }

  public Collection&lt;String&gt; impactSoftwareQualities() {
<span class="fc" id="L176">    return impactSoftwareQualities;</span>
  }

  public Collection&lt;String&gt; statuses() {
<span class="fc" id="L180">    return statuses;</span>
  }

  public Collection&lt;String&gt; issueStatuses() {
<span class="fc" id="L184">    return issueStatuses;</span>
  }

  public Collection&lt;String&gt; resolutions() {
<span class="fc" id="L188">    return resolutions;</span>
  }

  public Collection&lt;String&gt; componentUuids() {
<span class="fc" id="L192">    return components;</span>
  }

  public Collection&lt;String&gt; projectUuids() {
<span class="fc" id="L196">    return projects;</span>
  }

  public Collection&lt;String&gt; directories() {
<span class="fc" id="L200">    return directories;</span>
  }

  public Collection&lt;String&gt; files() {
<span class="fc" id="L204">    return files;</span>
  }

  /**
   * Restrict issues belonging to projects that were analyzed under a view.
   * The view UUIDs should be portfolios, sub portfolios or application branches.
   */
  public Collection&lt;String&gt; viewUuids() {
<span class="fc" id="L212">    return views;</span>
  }

  public Collection&lt;RuleDto&gt; rules() {
<span class="fc" id="L216">    return rules;</span>
  }

  public Collection&lt;String&gt; ruleUuids() {
<span class="fc" id="L220">    return ruleUuids;</span>
  }

  public Collection&lt;String&gt; assignees() {
<span class="fc" id="L224">    return assignees;</span>
  }

  public Collection&lt;String&gt; authors() {
<span class="fc" id="L228">    return authors;</span>
  }

  public Collection&lt;String&gt; scopes() {
<span class="fc" id="L232">    return scopes;</span>
  }

  public Collection&lt;String&gt; languages() {
<span class="fc" id="L236">    return languages;</span>
  }

  public Collection&lt;String&gt; tags() {
<span class="fc" id="L240">    return tags;</span>
  }

  public Collection&lt;String&gt; types() {
<span class="fc" id="L244">    return types;</span>
  }

  public Collection&lt;String&gt; pciDss32() {
<span class="fc" id="L248">    return pciDss32;</span>
  }

  public Collection&lt;String&gt; pciDss40() {
<span class="fc" id="L252">    return pciDss40;</span>
  }

  public Collection&lt;String&gt; owaspAsvs40() {
<span class="fc" id="L256">    return owaspAsvs40;</span>
  }

  public Optional&lt;Integer&gt; getOwaspAsvsLevel() {
<span class="fc" id="L260">    return Optional.ofNullable(owaspAsvsLevel);</span>
  }

  public Collection&lt;String&gt; owaspMobileTop10For2024() {
<span class="fc" id="L264">    return owaspMobileTop10For2024;</span>
  }

  public Collection&lt;String&gt; owaspTop10() {
<span class="fc" id="L268">    return owaspTop10;</span>
  }

  public Collection&lt;String&gt; owaspTop10For2021() {
<span class="fc" id="L272">    return owaspTop10For2021;</span>
  }

  public Collection&lt;String&gt; stigAsdV5R3() {
<span class="fc" id="L276">    return stigAsdV5R3;</span>
  }

  public Collection&lt;String&gt; casa() {
<span class="fc" id="L280">    return casa;</span>
  }

  public Collection&lt;String&gt; sansTop25() {
<span class="fc" id="L284">    return sansTop25;</span>
  }

  public Collection&lt;String&gt; cwe() {
<span class="fc" id="L288">    return cwe;</span>
  }

  public Collection&lt;String&gt; sonarsourceSecurity() {
<span class="fc" id="L292">    return sonarsourceSecurity;</span>
  }

  public Map&lt;String, PeriodStart&gt; createdAfterByProjectUuids() {
<span class="fc" id="L296">    return createdAfterByProjectUuids;</span>
  }

  @CheckForNull
  public Boolean onComponentOnly() {
<span class="fc" id="L301">    return onComponentOnly;</span>
  }

  @CheckForNull
  public Boolean assigned() {
<span class="fc" id="L306">    return assigned;</span>
  }

  @CheckForNull
  public Boolean resolved() {
<span class="fc" id="L311">    return resolved;</span>
  }

  @CheckForNull
  public Boolean prioritizedRule() {
<span class="fc" id="L316">    return prioritizedRule;</span>
  }

  @CheckForNull
  public Boolean fromSonarQubeUpdate() {
<span class="fc" id="L321">    return fromSonarQubeUpdate;</span>
  }

  @CheckForNull
  public PeriodStart createdAfter() {
<span class="fc" id="L326">    return createdAfter;</span>
  }

  @CheckForNull
  public Date createdAt() {
<span class="fc bfc" id="L331" title="All 2 branches covered.">    return createdAt == null ? null : new Date(createdAt.getTime());</span>
  }

  @CheckForNull
  public Date createdBefore() {
<span class="fc bfc" id="L336" title="All 2 branches covered.">    return createdBefore == null ? null : new Date(createdBefore.getTime());</span>
  }

  @CheckForNull
  public String sort() {
<span class="fc" id="L341">    return sort;</span>
  }

  @CheckForNull
  public Boolean asc() {
<span class="fc" id="L346">    return asc;</span>
  }

  @CheckForNull
  public String branchUuid() {
<span class="fc" id="L351">    return branchUuid;</span>
  }

  public Boolean isMainBranch() {
<span class="fc" id="L355">    return mainBranch;</span>
  }

  public String facetMode() {
<span class="fc" id="L359">    return facetMode;</span>
  }

  @Override
  public String toString() {
<span class="nc" id="L364">    return ReflectionToStringBuilder.toString(this);</span>
  }

  public static Builder builder() {
<span class="fc" id="L368">    return new Builder();</span>
  }

  @CheckForNull
  public ZoneId timeZone() {
<span class="fc" id="L373">    return timeZone;</span>
  }

  @CheckForNull
  public Boolean newCodeOnReference() {
<span class="fc" id="L378">    return newCodeOnReference;</span>
  }

  public Collection&lt;String&gt; newCodeOnReferenceByProjectUuids() {
<span class="fc" id="L382">    return newCodeOnReferenceByProjectUuids;</span>
  }

  public Collection&lt;String&gt; codeVariants() {
<span class="fc" id="L386">    return codeVariants;</span>
  }

  public Collection&lt;String&gt; cleanCodeAttributesCategories() {
<span class="fc" id="L390">    return cleanCodeAttributesCategories;</span>
  }

  public static class Builder {
    private Collection&lt;String&gt; issueKeys;
    private Collection&lt;String&gt; severities;
    private Collection&lt;String&gt; impactSeverities;
    private Collection&lt;String&gt; impactSoftwareQualities;
    private Collection&lt;String&gt; statuses;
    private Collection&lt;String&gt; resolutions;
    private Collection&lt;String&gt; issueStatuses;
    private Collection&lt;String&gt; components;
    private Collection&lt;String&gt; projects;
    private Collection&lt;String&gt; directories;
    private Collection&lt;String&gt; files;
    private Collection&lt;String&gt; views;
    private Collection&lt;RuleDto&gt; rules;
    private Collection&lt;String&gt; ruleUuids;
    private Collection&lt;String&gt; assigneeUuids;
    private Collection&lt;String&gt; authors;
    private Collection&lt;String&gt; scopes;
    private Collection&lt;String&gt; languages;
    private Collection&lt;String&gt; tags;
    private Collection&lt;String&gt; types;
    private Collection&lt;String&gt; pciDss32;
    private Collection&lt;String&gt; pciDss40;
    private Collection&lt;String&gt; owaspAsvs40;
    private Integer owaspAsvsLevel;
    private Collection&lt;String&gt; owaspMobileTop10For2024;
    private Collection&lt;String&gt; owaspTop10;
    private Collection&lt;String&gt; owaspTop10For2021;
    private Collection&lt;String&gt; stigAsdV5R3;
    private Collection&lt;String&gt; casa;
    private Collection&lt;String&gt; sansTop25;
    private Collection&lt;String&gt; cwe;
    private Collection&lt;String&gt; sonarsourceSecurity;
    private Map&lt;String, PeriodStart&gt; createdAfterByProjectUuids;
<span class="fc" id="L427">    private Boolean onComponentOnly = false;</span>
<span class="fc" id="L428">    private Boolean assigned = null;</span>
<span class="fc" id="L429">    private Boolean resolved = null;</span>
<span class="fc" id="L430">    private Boolean prioritizedRule = null;</span>
<span class="fc" id="L431">    private Boolean fromSonarQubeUpdate = null;</span>
    private Date createdAt;
    private PeriodStart createdAfter;
    private Date createdBefore;
    private String sort;
<span class="fc" id="L436">    private Boolean asc = false;</span>
    private String facetMode;
    private String branchUuid;
<span class="fc" id="L439">    private Boolean mainBranch = true;</span>
    private ZoneId timeZone;
<span class="fc" id="L441">    private Boolean newCodeOnReference = null;</span>
    private Collection&lt;String&gt; newCodeOnReferenceByProjectUuids;
    private Collection&lt;String&gt; codeVariants;
    private Collection&lt;String&gt; cleanCodeAttributesCategories;

<span class="fc" id="L446">    private Builder() {</span>

<span class="fc" id="L448">    }</span>

    public Builder issueKeys(@Nullable Collection&lt;String&gt; l) {
<span class="fc" id="L451">      this.issueKeys = l;</span>
<span class="fc" id="L452">      return this;</span>
    }

    public Builder severities(@Nullable Collection&lt;String&gt; l) {
<span class="fc" id="L456">      this.severities = l;</span>
<span class="fc" id="L457">      return this;</span>
    }

    public Builder statuses(@Nullable Collection&lt;String&gt; l) {
<span class="fc" id="L461">      this.statuses = l;</span>
<span class="fc" id="L462">      return this;</span>
    }

    public Builder resolutions(@Nullable Collection&lt;String&gt; l) {
<span class="fc" id="L466">      this.resolutions = l;</span>
<span class="fc" id="L467">      return this;</span>
    }

    public Builder issueStatuses(@Nullable Collection&lt;String&gt; l) {
<span class="fc" id="L471">      this.issueStatuses = l;</span>
<span class="fc" id="L472">      return this;</span>
    }

    public Builder componentUuids(@Nullable Collection&lt;String&gt; l) {
<span class="fc" id="L476">      this.components = l;</span>
<span class="fc" id="L477">      return this;</span>
    }

    public Builder projectUuids(@Nullable Collection&lt;String&gt; l) {
<span class="fc" id="L481">      this.projects = l;</span>
<span class="fc" id="L482">      return this;</span>
    }

    public Builder directories(@Nullable Collection&lt;String&gt; l) {
<span class="fc" id="L486">      this.directories = l;</span>
<span class="fc" id="L487">      return this;</span>
    }

    public Builder impactSeverities(@Nullable Collection&lt;String&gt; l) {
<span class="fc" id="L491">      this.impactSeverities = l;</span>
<span class="fc" id="L492">      return this;</span>
    }

    public Builder impactSoftwareQualities(@Nullable Collection&lt;String&gt; l) {
<span class="fc" id="L496">      this.impactSoftwareQualities = l;</span>
<span class="fc" id="L497">      return this;</span>
    }

    public Builder files(@Nullable Collection&lt;String&gt; l) {
<span class="fc" id="L501">      this.files = l;</span>
<span class="fc" id="L502">      return this;</span>
    }

    /**
     * Restrict issues belonging to projects that were analyzed under a view.
     * The view UUIDs should be portfolios, sub portfolios or application branches.
     */
    public Builder viewUuids(@Nullable Collection&lt;String&gt; l) {
<span class="fc" id="L510">      this.views = l;</span>
<span class="fc" id="L511">      return this;</span>
    }

    public Builder rules(@Nullable Collection&lt;RuleDto&gt; rules) {
<span class="fc" id="L515">      this.rules = rules;</span>
<span class="fc" id="L516">      return this;</span>
    }

    public Builder ruleUuids(@Nullable Collection&lt;String&gt; ruleUuids) {
<span class="fc" id="L520">      this.ruleUuids = ruleUuids;</span>
<span class="fc" id="L521">      return this;</span>
    }

    public Builder assigneeUuids(@Nullable Collection&lt;String&gt; l) {
<span class="fc" id="L525">      this.assigneeUuids = l;</span>
<span class="fc" id="L526">      return this;</span>
    }

    public Builder authors(@Nullable Collection&lt;String&gt; l) {
<span class="fc" id="L530">      this.authors = l;</span>
<span class="fc" id="L531">      return this;</span>
    }

    public Builder scopes(@Nullable Collection&lt;String&gt; s) {
<span class="fc" id="L535">      this.scopes = s;</span>
<span class="fc" id="L536">      return this;</span>
    }

    public Builder languages(@Nullable Collection&lt;String&gt; l) {
<span class="fc" id="L540">      this.languages = l;</span>
<span class="fc" id="L541">      return this;</span>
    }

    public Builder tags(@Nullable Collection&lt;String&gt; t) {
<span class="fc" id="L545">      this.tags = t;</span>
<span class="fc" id="L546">      return this;</span>
    }

    public Builder types(@Nullable Collection&lt;String&gt; t) {
<span class="fc" id="L550">      this.types = t;</span>
<span class="fc" id="L551">      return this;</span>
    }

    public Builder pciDss32(@Nullable Collection&lt;String&gt; o) {
<span class="fc" id="L555">      this.pciDss32 = o;</span>
<span class="fc" id="L556">      return this;</span>
    }

    public Builder pciDss40(@Nullable Collection&lt;String&gt; o) {
<span class="fc" id="L560">      this.pciDss40 = o;</span>
<span class="fc" id="L561">      return this;</span>
    }

    public Builder owaspAsvs40(@Nullable Collection&lt;String&gt; o) {
<span class="fc" id="L565">      this.owaspAsvs40 = o;</span>
<span class="fc" id="L566">      return this;</span>
    }

    public Builder owaspAsvsLevel(@Nullable Integer level) {
<span class="fc" id="L570">      this.owaspAsvsLevel = level;</span>
<span class="fc" id="L571">      return this;</span>
    }

    public Builder owaspMobileTop10For2024(@Nullable Collection&lt;String&gt; o) {
<span class="fc" id="L575">      this.owaspMobileTop10For2024 = o;</span>
<span class="fc" id="L576">      return this;</span>
    }

    public Builder owaspTop10(@Nullable Collection&lt;String&gt; o) {
<span class="fc" id="L580">      this.owaspTop10 = o;</span>
<span class="fc" id="L581">      return this;</span>
    }

    public Builder owaspTop10For2021(@Nullable Collection&lt;String&gt; o) {
<span class="fc" id="L585">      this.owaspTop10For2021 = o;</span>
<span class="fc" id="L586">      return this;</span>
    }

    public Builder stigAsdR5V3(@Nullable Collection&lt;String&gt; o) {
<span class="fc" id="L590">      this.stigAsdV5R3 = o;</span>
<span class="fc" id="L591">      return this;</span>
    }

    public Builder casa(@Nullable Collection&lt;String&gt; o) {
<span class="fc" id="L595">      this.casa = o;</span>
<span class="fc" id="L596">      return this;</span>
    }

    public Builder sansTop25(@Nullable Collection&lt;String&gt; s) {
<span class="fc" id="L600">      this.sansTop25 = s;</span>
<span class="fc" id="L601">      return this;</span>
    }

    public Builder cwe(@Nullable Collection&lt;String&gt; cwe) {
<span class="fc" id="L605">      this.cwe = cwe;</span>
<span class="fc" id="L606">      return this;</span>
    }

    public Builder sonarsourceSecurity(@Nullable Collection&lt;String&gt; sonarsourceSecurity) {
<span class="fc" id="L610">      this.sonarsourceSecurity = sonarsourceSecurity;</span>
<span class="fc" id="L611">      return this;</span>
    }

    public Builder createdAfterByProjectUuids(@Nullable Map&lt;String, PeriodStart&gt; createdAfterByProjectUuids) {
<span class="fc" id="L615">      this.createdAfterByProjectUuids = createdAfterByProjectUuids;</span>
<span class="fc" id="L616">      return this;</span>
    }

    /**
     * If true, it will return only issues on the passed component(s)
     * If false, it will return all issues on the passed component(s) and their descendants
     */
    public Builder onComponentOnly(@Nullable Boolean b) {
<span class="fc" id="L624">      this.onComponentOnly = b;</span>
<span class="fc" id="L625">      return this;</span>
    }

    /**
     * If true, it will return all issues assigned to someone
     * If false, it will return all issues not assigned to someone
     */
    public Builder assigned(@Nullable Boolean b) {
<span class="fc" id="L633">      this.assigned = b;</span>
<span class="fc" id="L634">      return this;</span>
    }

    /**
     * If true, it will return all resolved issues
     * If false, it will return all none resolved issues
     */
    public Builder resolved(@Nullable Boolean resolved) {
<span class="fc" id="L642">      this.resolved = resolved;</span>
<span class="fc" id="L643">      return this;</span>
    }

    public Builder prioritizedRule(@Nullable Boolean prioritizedRule) {
<span class="fc" id="L647">      this.prioritizedRule = prioritizedRule;</span>
<span class="fc" id="L648">      return this;</span>
    }

    public Builder fromSonarQubeUpdate(@Nullable Boolean fromSonarQubeUpdate) {
<span class="fc" id="L652">      this.fromSonarQubeUpdate = fromSonarQubeUpdate;</span>
<span class="fc" id="L653">      return this;</span>
    }


    public Builder createdAt(@Nullable Date d) {
<span class="fc bfc" id="L658" title="All 2 branches covered.">      this.createdAt = d == null ? null : new Date(d.getTime());</span>
<span class="fc" id="L659">      return this;</span>
    }

    public Builder createdAfter(@Nullable Date d) {
<span class="fc" id="L663">      this.createdAfter(d, true);</span>
<span class="fc" id="L664">      return this;</span>
    }

    public Builder createdAfter(@Nullable Date d, boolean inclusive) {
<span class="fc bfc" id="L668" title="All 2 branches covered.">      this.createdAfter = d == null ? null : new PeriodStart(new Date(d.getTime()), inclusive);</span>
<span class="fc" id="L669">      return this;</span>
    }

    public Builder createdBefore(@Nullable Date d) {
<span class="fc bfc" id="L673" title="All 2 branches covered.">      this.createdBefore = d == null ? null : new Date(d.getTime());</span>
<span class="fc" id="L674">      return this;</span>
    }

    public Builder sort(@Nullable String s) {
<span class="fc bfc" id="L678" title="All 4 branches covered.">      if (s != null &amp;&amp; !SORTS.contains(s)) {</span>
<span class="fc" id="L679">        throw new IllegalArgumentException(&quot;Bad sort field: &quot; + s);</span>
      }
<span class="fc" id="L681">      this.sort = s;</span>
<span class="fc" id="L682">      return this;</span>
    }

    public Builder asc(@Nullable Boolean asc) {
<span class="fc" id="L686">      this.asc = asc;</span>
<span class="fc" id="L687">      return this;</span>
    }

    public IssueQuery build() {
<span class="fc" id="L691">      return new IssueQuery(this);</span>
    }

    public Builder facetMode(String facetMode) {
<span class="fc" id="L695">      this.facetMode = facetMode;</span>
<span class="fc" id="L696">      return this;</span>
    }

    public Builder branchUuid(@Nullable String s) {
<span class="fc" id="L700">      this.branchUuid = s;</span>
<span class="fc" id="L701">      return this;</span>
    }

    public Builder mainBranch(@Nullable Boolean mainBranch) {
<span class="fc" id="L705">      this.mainBranch = mainBranch;</span>
<span class="fc" id="L706">      return this;</span>
    }

    public Builder timeZone(ZoneId timeZone) {
<span class="fc" id="L710">      this.timeZone = timeZone;</span>
<span class="fc" id="L711">      return this;</span>
    }

    public Builder newCodeOnReference(@Nullable Boolean newCodeOnReference) {
<span class="fc" id="L715">      this.newCodeOnReference = newCodeOnReference;</span>
<span class="fc" id="L716">      return this;</span>
    }

    public Builder newCodeOnReferenceByProjectUuids(@Nullable Collection&lt;String&gt; newCodeOnReferenceByProjectUuids) {
<span class="fc" id="L720">      this.newCodeOnReferenceByProjectUuids = newCodeOnReferenceByProjectUuids;</span>
<span class="fc" id="L721">      return this;</span>
    }

    public Builder codeVariants(@Nullable Collection&lt;String&gt; codeVariants) {
<span class="fc" id="L725">      this.codeVariants = codeVariants;</span>
<span class="fc" id="L726">      return this;</span>
    }

    public Builder cleanCodeAttributesCategories(@Nullable Collection&lt;String&gt; cleanCodeAttributesCategories) {
<span class="fc" id="L730">      this.cleanCodeAttributesCategories = cleanCodeAttributesCategories;</span>
<span class="fc" id="L731">      return this;</span>
    }
  }

  private static &lt;T&gt; Collection&lt;T&gt; defaultCollection(@Nullable Collection&lt;T&gt; c) {
<span class="fc bfc" id="L736" title="All 2 branches covered.">    return c == null ? Collections.emptyList() : Collections.unmodifiableCollection(c);</span>
  }

  private static &lt;T&gt; Collection&lt;T&gt; nullableDefaultCollection(@Nullable Collection&lt;T&gt; c) {
<span class="fc bfc" id="L740" title="All 2 branches covered.">    return c == null ? null : Collections.unmodifiableCollection(c);</span>
  }

  private static &lt;K, V&gt; Map&lt;K, V&gt; defaultMap(@Nullable Map&lt;K, V&gt; map) {
<span class="fc bfc" id="L744" title="All 2 branches covered.">    return map == null ? Collections.emptyMap() : Collections.unmodifiableMap(map);</span>
  }

  public static class PeriodStart {
    private final Date date;
    private final boolean inclusive;

<span class="fc" id="L751">    public PeriodStart(Date date, boolean inclusive) {</span>
<span class="fc" id="L752">      this.date = date;</span>
<span class="fc" id="L753">      this.inclusive = inclusive;</span>

<span class="fc" id="L755">    }</span>

    public Date date() {
<span class="fc" id="L758">      return date;</span>
    }

    public boolean inclusive() {
<span class="fc" id="L762">      return inclusive;</span>
    }

  }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>