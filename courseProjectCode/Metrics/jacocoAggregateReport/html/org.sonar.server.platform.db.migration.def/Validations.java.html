<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Validations.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">sonarqube</a> &gt; <a href="index.source.html" class="el_package">org.sonar.server.platform.db.migration.def</a> &gt; <span class="el_source">Validations.java</span></div><h1>Validations.java</h1><pre class="source lang-java linenums">/*
 * SonarQube
 * Copyright (C) 2009-2025 SonarSource SA
 * mailto:info AT sonarsource DOT com
 *
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 3 of the License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with this program; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
 */
package org.sonar.server.platform.db.migration.def;

import com.google.common.base.CharMatcher;
import java.util.List;
import java.util.Locale;
import java.util.Set;
import java.util.stream.Collectors;
import java.util.stream.Stream;
import javax.annotation.Nullable;

import static com.google.common.base.CharMatcher.anyOf;
import static com.google.common.base.CharMatcher.inRange;
import static com.google.common.base.Preconditions.checkArgument;
import static com.google.common.base.Preconditions.checkNotNull;
import static java.util.Objects.requireNonNull;

public class Validations {

  private static final int TABLE_NAME_MAX_SIZE = 25;
  private static final int CONSTRAINT_NAME_MAX_SIZE = 30;
  private static final int INDEX_NAME_MAX_SIZE = 30;

<span class="fc" id="L42">  private static final CharMatcher DIGIT_CHAR_MATCHER = inRange('0', '9');</span>
<span class="fc" id="L43">  private static final CharMatcher LOWER_CASE_ASCII_LETTERS_CHAR_MATCHER = inRange('a', 'z');</span>
<span class="fc" id="L44">  private static final CharMatcher UPPER_CASE_ASCII_LETTERS_CHAR_MATCHER = inRange('A', 'Z');</span>
<span class="fc" id="L45">  private static final CharMatcher UNDERSCORE_CHAR_MATCHER = anyOf(&quot;_&quot;);</span>

  // TODO: Refactor all existing identifiers that match SQL reserved keywords,
  // the list below is used as a workaround for validating existing non-complaint identifiers
  private static final String VALUE_COLUMN_NAME = &quot;value&quot;;
  private static final String GROUPS_TABLE_NAME = &quot;groups&quot;;
<span class="fc" id="L51">  private static final List&lt;String&gt; ALLOWED_IDENTIFIERS = List.of(VALUE_COLUMN_NAME, GROUPS_TABLE_NAME);</span>

  // MS SQL keywords retrieved from: com.microsoft.sqlserver.jdbc.SQLServerDatabaseMetaData#createSqlKeyWords
<span class="fc" id="L54">  protected static final Set&lt;String&gt; MSSQL_KEYWORDS =  Set.of(</span>
          &quot;ADD&quot;, &quot;ALL&quot;, &quot;ALTER&quot;, &quot;AND&quot;, &quot;ANY&quot;, &quot;AS&quot;, &quot;ASC&quot;, &quot;AUTHORIZATION&quot;,
          &quot;BACKUP&quot;, &quot;BEGIN&quot;, &quot;BETWEEN&quot;, &quot;BREAK&quot;, &quot;BROWSE&quot;, &quot;BULK&quot;, &quot;BY&quot;,
          &quot;CASCADE&quot;, &quot;CASE&quot;, &quot;CHECK&quot;, &quot;CHECKPOINT&quot;, &quot;CLOSE&quot;, &quot;CLUSTERED&quot;, &quot;COALESCE&quot;, &quot;COLLATE&quot;, &quot;COLUMN&quot;, &quot;COMMIT&quot;, &quot;COMPUTE&quot;, &quot;CONSTRAINT&quot;, &quot;CONTAINS&quot;,
          &quot;CONTAINSTABLE&quot;, &quot;CONTINUE&quot;, &quot;CONVERT&quot;, &quot;CREATE&quot;, &quot;CROSS&quot;, &quot;CURRENT&quot;, &quot;CURRENT_DATE&quot;, &quot;CURRENT_TIME&quot;, &quot;CURRENT_TIMESTAMP&quot;, &quot;CURRENT_USER,CURSOR&quot;,
          &quot;DATABASE&quot;, &quot;DBCC&quot;, &quot;DEALLOCATE&quot;, &quot;DECLARE&quot;, &quot;DEFAULT&quot;, &quot;DELETE&quot;, &quot;DENY&quot;, &quot;DESC&quot;, &quot;DISK&quot;, &quot;DISTINCT&quot;, &quot;DISTRIBUTED&quot;, &quot;DOUBLE&quot;, &quot;DROP&quot;, &quot;DUMP&quot;,
          &quot;ELSE&quot;, &quot;END&quot;, &quot;ERRLVL&quot;, &quot;ESCAPE&quot;, &quot;EXCEPT&quot;, &quot;EXEC&quot;, &quot;EXECUTE&quot;, &quot;EXISTS&quot;, &quot;EXIT&quot;, &quot;EXTERNAL&quot;,
          &quot;FETCH&quot;, &quot;FILE&quot;, &quot;FILLFACTOR&quot;, &quot;FOR&quot;, &quot;FOREIGN&quot;, &quot;FREETEXT&quot;, &quot;FREETEXTTABLE&quot;, &quot;FROM&quot;, &quot;FULL&quot;, &quot;FUNCTION&quot;,
          &quot;GOTO&quot;, &quot;GRANT&quot;, &quot;GROUP&quot;,
          &quot;HAVING&quot;, &quot;HOLDLOCK&quot;,
          &quot;IDENTITY&quot;, &quot;IDENTITY_INSERT&quot;, &quot;IDENTITYCOL&quot;, &quot;IF&quot;, &quot;IN&quot;, &quot;INDEX&quot;, &quot;INNER&quot;, &quot;INSERT&quot;, &quot;INTERSECT&quot;, &quot;INTO&quot;, &quot;IS&quot;,
          &quot;JOIN&quot;,
          &quot;KEY&quot;, &quot;KILL&quot;,
          &quot;LEFT&quot;, &quot;LIKE&quot;,
          &quot;LINENO&quot;, &quot;LOAD&quot;,
          &quot;MERGE&quot;,
          &quot;NATIONAL&quot;, &quot;NOCHECK&quot;, &quot;NONCLUSTERED&quot;, &quot;NOT&quot;, &quot;NULL&quot;, &quot;NULLIF&quot;,
          &quot;OF&quot;, &quot;OFF&quot;, &quot;OFFSETS&quot;, &quot;ON&quot;, &quot;OPEN&quot;, &quot;OPENDATASOURCE&quot;, &quot;OPENQUERY&quot;, &quot;OPENROWSET&quot;, &quot;OPENXML&quot;, &quot;OPTION&quot;, &quot;OR&quot;, &quot;ORDER&quot;, &quot;OUTER&quot;, &quot;OVER&quot;,
          &quot;PERCENT&quot;, &quot;PIVOT&quot;, &quot;PLAN&quot;, &quot;PRECISION&quot;, &quot;PRIMARY&quot;, &quot;PRINT&quot;, &quot;PROC&quot;, &quot;PROCEDURE&quot;, &quot;PUBLIC&quot;,
          &quot;RAISERROR&quot;, &quot;READ&quot;, &quot;READTEXT&quot;, &quot;RECONFIGURE&quot;, &quot;REFERENCES&quot;, &quot;REPLICATION&quot;, &quot;RESTORE&quot;, &quot;RESTRICT&quot;,
          &quot;RETURN&quot;, &quot;REVERT&quot;, &quot;REVOKE&quot;, &quot;RIGHT&quot;, &quot;ROLLBACK&quot;, &quot;ROWCOUNT&quot;, &quot;ROWGUIDCOL&quot;, &quot;RULE&quot;,
          &quot;SAVE&quot;, &quot;SCHEMA&quot;, &quot;SECURITYAUDIT&quot;, &quot;SELECT&quot;, &quot;SEMANTICKEYPHRASETABLE&quot;, &quot;SEMANTICSIMILARITYDETAILSTABLE&quot;,
          &quot;SEMANTICSIMILARITYTABLE&quot;, &quot;SESSION_USER&quot;, &quot;SET&quot;, &quot;SETUSER&quot;, &quot;SHUTDOWN&quot;, &quot;SOME&quot;, &quot;STATISTICS&quot;, &quot;SYSTEM_USER&quot;,
          &quot;TABLE&quot;, &quot;TABLESAMPLE&quot;, &quot;TEXTSIZE&quot;, &quot;THEN&quot;, &quot;TO&quot;, &quot;TOP&quot;, &quot;TRAN&quot;, &quot;TRANSACTION&quot;, &quot;TRIGGER&quot;, &quot;TRUNCATE&quot;, &quot;TRY_CONVERT&quot;, &quot;TSEQUAL&quot;,
          &quot;UNION&quot;, &quot;UNIQUE&quot;, &quot;UNPIVOT&quot;, &quot;UPDATE&quot;, &quot;UPDATETEXT&quot;, &quot;USE&quot;, &quot;USER&quot;,
          &quot;VALUES&quot;, &quot;VARYING&quot;, &quot;VIEW&quot;,
          &quot;WAITFOR&quot;, &quot;WHEN&quot;, &quot;WHERE&quot;, &quot;WHILE&quot;, &quot;WITH&quot;, &quot;WITHIN GROUP&quot;, &quot;WRITETEXT&quot;);

  // H2 SQL keywords retrieved from: http://www.h2database.com/html/advanced.html
<span class="fc" id="L83">  protected static final Set&lt;String&gt; H2_KEYWORDS =  Set.of(</span>
          &quot;ALL&quot;, &quot;AND&quot;, &quot;ANY&quot;, &quot;ARRAY&quot;, &quot;AS&quot;, &quot;ASYMMETRIC&quot;, &quot;AUTHORIZATION&quot;,
          &quot;BETWEEN&quot;, &quot;BOTH&quot;,
          &quot;CASE&quot;, &quot;CAST&quot;, &quot;CHECK&quot;, &quot;CONSTRAINT&quot;, &quot;CROSS&quot;, &quot;CURRENT_CATALOG&quot;, &quot;CURRENT_DATE&quot;, &quot;CURRENT_PATH&quot;,
          &quot;CURRENT_ROLE&quot;, &quot;CURRENT_SCHEMA&quot;, &quot;CURRENT_TIME&quot;, &quot;CURRENT_TIMESTAMP&quot;, &quot;CURRENT_USER&quot;,
          &quot;DAY&quot;, &quot;DEFAULT&quot;, &quot;DISTINCT&quot;,
          &quot;ELSE&quot;, &quot;END&quot;, &quot;EXISTS&quot;,
          &quot;FALSE&quot;, &quot;FETCH&quot;, &quot;FILTER&quot;, &quot;FOR&quot;, &quot;FOREIGN&quot;, &quot;FROM&quot;, &quot;FULL&quot;,
          &quot;GROUP&quot;, &quot;GROUPS&quot;,
          &quot;HAVING&quot;, &quot;HOUR&quot;,
          &quot;IF&quot;, &quot;ILIKE&quot;, &quot;IN&quot;, &quot;INNER&quot;, &quot;INTERSECT&quot;, &quot;INTERVAL&quot;, &quot;IS&quot;,
          &quot;JOIN&quot;,
          &quot;KEY&quot;,
          &quot;LEADING&quot;, &quot;LEFT&quot;, &quot;LIKE&quot;, &quot;LIMIT&quot;, &quot;LOCALTIME&quot;, &quot;LOCALTIMESTAMP&quot;,
          &quot;MINUS&quot;, &quot;MINUTE&quot;, &quot;MONTH&quot;,
          &quot;NATURAL&quot;, &quot;NOT&quot;, &quot;NULL&quot;,
          &quot;OFFSET&quot;, &quot;ON&quot;, &quot;OR&quot;, &quot;ORDER&quot;, &quot;OVER&quot;,
          &quot;PARTITION&quot;, &quot;PRIMARY&quot;,
          &quot;QUALIFY&quot;,
          &quot;RANGE&quot;, &quot;REGEXP&quot;, &quot;RIGHT&quot;, &quot;ROW&quot;, &quot;ROWNUM&quot;, &quot;ROWS&quot;,
          &quot;SECOND&quot;, &quot;SELECT&quot;, &quot;SESSION_USER&quot;, &quot;SET&quot;, &quot;SOME&quot;, &quot;SYMMETRIC&quot;, &quot;SYSTEM_USER&quot;,
          &quot;TABLE&quot;, &quot;TO&quot;, &quot;TOP&quot;, &quot;TRAILING&quot;, &quot;TRUE&quot;,
          &quot;UESCAPE&quot;, &quot;UNION&quot;, &quot;UNIQUE&quot;, &quot;UNKNOWN&quot;, &quot;USER&quot;, &quot;USING&quot;,
          &quot;VALUE&quot;, &quot;VALUES&quot;,
          &quot;WHEN&quot;, &quot;WHERE&quot;, &quot;WINDOW&quot;, &quot;WITH&quot;,
          &quot;YEAR&quot;,
          &quot;_ROWID_&quot;);

  // PostgreSQL keywords retrieved from: https://www.postgresql.org/docs/current/sql-keywords-appendix.html
<span class="fc" id="L112">  protected static final Set&lt;String&gt; POSTGRESQL_KEYWORDS =  Set.of(</span>
          &quot;ALL&quot;, &quot;AND&quot;, &quot;ANY&quot;, &quot;ARRAY&quot;, &quot;AS&quot;, &quot;ASYMMETRIC&quot;,
          &quot;BIGINT&quot;, &quot;BINARY&quot;, &quot;BIT&quot;, &quot;BOOLEAN&quot;, &quot;BOTH&quot;,
          &quot;CASE&quot;, &quot;CAST&quot;, &quot;CHAR&quot;, &quot;CHARACTER&quot;, &quot;COALESCE&quot;, &quot;COLLATE&quot;, &quot;COLLATION&quot;, &quot;COLUMN&quot;, &quot;CONCURRENTLY&quot;, &quot;CREATE&quot;,
          &quot;CURRENT_CATALOG&quot;, &quot;CURRENT_ROLE&quot;, &quot;CURRENT_SCHEMA&quot;, &quot;CURRENT_USER&quot;,
          &quot;DEC&quot;, &quot;DECIMAL&quot;, &quot;DEFERRABLE&quot;, &quot;DESC&quot;,
          &quot;ELSE&quot;, &quot;END&quot;, &quot;EXCEPT&quot;,
          &quot;FALSE&quot;, &quot;FOR&quot;, &quot;FREEZE&quot;, &quot;FROM&quot;, &quot;FULL&quot;,
          &quot;GRANT&quot;, &quot;GREATEST&quot;, &quot;GROUPING&quot;,
          &quot;ILIKE&quot;, &quot;IN&quot;, &quot;INITIALLY&quot;, &quot;INTO&quot;, &quot;IS&quot;, &quot;ISNULL&quot;,
          &quot;JOIN&quot;,
          &quot;LATERAL&quot;, &quot;LEADING&quot;, &quot;LEFT&quot;, &quot;LIKE&quot;, &quot;LIMIT&quot;, &quot;LOCALTIME&quot;, &quot;LOCALTIMESTAMP&quot;,
          &quot;NATIONAL&quot;, &quot;NATURAL&quot;, &quot;NCHAR&quot;, &quot;NOT&quot;, &quot;NOTNULL&quot;, &quot;NULL&quot;,
          &quot;OFFSET&quot;, &quot;ON&quot;, &quot;ONLY&quot;, &quot;OR&quot;, &quot;OUTER&quot;, &quot;OVERLAPS&quot;,
          &quot;PLACING&quot;,
          &quot;REFERENCES&quot;, &quot;RETURNING&quot;,
          &quot;SETOF&quot;, &quot;SIMILAR&quot;, &quot;SMALLINT&quot;, &quot;SOME&quot;, &quot;SUBSTRING&quot;, &quot;SYMMETRIC&quot;,
          &quot;TABLESAMPLE&quot;, &quot;THEN&quot;, &quot;TIME&quot;, &quot;TIMESTAMP&quot;, &quot;TO&quot;, &quot;TRAILING&quot;, &quot;TREAT&quot;, &quot;TRIM&quot;, &quot;TRUE&quot;,
          &quot;USER&quot;, &quot;USING&quot;,
          &quot;VARCHAR&quot;, &quot;VARIADIC&quot;, &quot;VERBOSE&quot;,
          &quot;WHEN&quot;, &quot;WINDOW&quot;, &quot;WITH&quot;,
          &quot;XMLCONCAT&quot;, &quot;XMLELEMENT&quot;, &quot;XMLEXISTS&quot;, &quot;XMLFOREST&quot;, &quot;XMLNAMESPACES&quot;, &quot;XMLPARSE&quot;, &quot;XMLPI&quot;, &quot;XMLROOT&quot;, &quot;XMLSERIALIZE&quot;, &quot;XMLTABLE&quot;,
          &quot;YEAR&quot;);

<span class="fc" id="L136">  protected static final  Set&lt;String&gt; ALL_KEYWORDS = Stream.of(MSSQL_KEYWORDS, H2_KEYWORDS, POSTGRESQL_KEYWORDS)</span>
<span class="fc" id="L137">          .flatMap(Set::stream)</span>
<span class="fc" id="L138">          .collect(Collectors.toSet());</span>

  private Validations() {
    // Only static stuff here
  }

  /**
   * Ensure {@code columnName} is a valid name for a column.
   * @throws NullPointerException if {@code columnName} is {@code null}
   * @throws IllegalArgumentException if {@code columnName} is not valid
   * @return the same {@code columnName}
   * @see #checkDbIdentifier(String, String, int)
   */
  public static String validateColumnName(@Nullable String columnName) {
<span class="fc" id="L152">    String name = requireNonNull(columnName, &quot;Column name cannot be null&quot;);</span>
<span class="fc" id="L153">    checkDbIdentifierCharacters(columnName, &quot;Column name&quot;);</span>
<span class="fc" id="L154">    return name;</span>
  }

  /**
   * Ensure {@code tableName} is a valid name for a table.
   * @throws NullPointerException if {@code tableName} is {@code null}
   * @throws IllegalArgumentException if {@code tableName} is not valid
   * @return the same {@code tableName}
   * @see #checkDbIdentifier(String, String, int)
   */
  public static String validateTableName(@Nullable String tableName) {
<span class="fc" id="L165">    checkDbIdentifier(tableName, &quot;Table name&quot;, TABLE_NAME_MAX_SIZE);</span>
<span class="fc" id="L166">    return tableName;</span>
  }

  /**
   * Ensure {@code constraintName} is a valid name for a constraint.
   * @throws NullPointerException if {@code constraintName} is {@code null}
   * @throws IllegalArgumentException if {@code constraintName} is not valid
   * @return the same {@code constraintName}
   * @see #checkDbIdentifier(String, String, int)
   */
  public static String validateConstraintName(@Nullable String constraintName) {
<span class="fc" id="L177">    checkDbIdentifier(constraintName, &quot;Constraint name&quot;, CONSTRAINT_NAME_MAX_SIZE);</span>
<span class="fc" id="L178">    return constraintName;</span>
  }

  /**
   * Ensure {@code indexName} is a valid name for an index.
   * @throws NullPointerException if {@code indexName} is {@code null}
   * @throws IllegalArgumentException if {@code indexName} is not valid
   * @return the same {@code indexName}
   * @see #checkDbIdentifier(String, String, int)
   */
  public static String validateIndexName(@Nullable String indexName) {
<span class="fc" id="L189">    checkDbIdentifier(indexName, &quot;Index name&quot;, INDEX_NAME_MAX_SIZE);</span>
<span class="fc" id="L190">    return indexName;</span>
  }

  public static String validateIndexNameIgnoreCase(@Nullable String indexName) {
<span class="fc" id="L194">    checkDbIdentifier(indexName, &quot;Index name&quot;, INDEX_NAME_MAX_SIZE, true);</span>
<span class="fc" id="L195">    return indexName;</span>
  }

  /**
   * Ensure {@code identifier} is a valid DB identifier.
   *
   * @throws NullPointerException if {@code identifier} is {@code null}
   * @throws IllegalArgumentException if {@code identifier} is empty
   * @throws IllegalArgumentException if {@code identifier} is longer than {@code maxSize}
   * @throws IllegalArgumentException if {@code identifier} is not lowercase
   * @throws IllegalArgumentException if {@code identifier} contains characters others than ASCII letters, ASCII numbers or {@code _}
   * @throws IllegalArgumentException if {@code identifier} starts with {@code _} or a number
   */
  static String checkDbIdentifier(@Nullable String identifier, String identifierDesc, int maxSize) {
<span class="fc" id="L209">    return checkDbIdentifier(identifier, identifierDesc, maxSize, false);</span>
  }

  static String checkDbIdentifier(@Nullable String identifier, String identifierDesc, int maxSize, boolean ignoreCase) {
<span class="fc" id="L213">    String res = checkNotNull(identifier, &quot;%s can't be null&quot;, identifierDesc);</span>
<span class="pc bpc" id="L214" title="1 of 2 branches missed.">    checkArgument(!res.isEmpty(), &quot;%s, can't be empty&quot;, identifierDesc);</span>
<span class="fc" id="L215">    checkArgument(</span>
<span class="fc bfc" id="L216" title="All 2 branches covered.">      identifier.length() &lt;= maxSize,</span>
      &quot;%s length can't be more than %s&quot;, identifierDesc, maxSize);
<span class="fc bfc" id="L218" title="All 2 branches covered.">    if (ignoreCase) {</span>
<span class="fc" id="L219">      checkDbIdentifierCharactersIgnoreCase(identifier, identifierDesc);</span>
    } else {
<span class="fc" id="L221">      checkDbIdentifierCharacters(identifier, identifierDesc);</span>
    }
<span class="fc" id="L223">    return res;</span>
  }

  private static boolean isSqlKeyword(String identifier) {
<span class="fc" id="L227">    return ALL_KEYWORDS.contains(identifier);</span>
  }

  private static boolean isSqlKeywordIgnoreCase(String identifier) {
<span class="fc" id="L231">    return isSqlKeyword(identifier.toUpperCase(Locale.ENGLISH));</span>
  }

  private static void checkDbIdentifierCharacters(String identifier, String identifierDesc) {
<span class="fc bfc" id="L235" title="All 2 branches covered.">    checkArgument(identifier.length() &gt; 0, &quot;Identifier must not be empty&quot;);</span>
<span class="fc" id="L236">    checkArgument(</span>
<span class="fc" id="L237">      LOWER_CASE_ASCII_LETTERS_CHAR_MATCHER.or(DIGIT_CHAR_MATCHER).or(anyOf(&quot;_&quot;)).matchesAllOf(identifier),</span>
      &quot;%s must be lower case and contain only alphanumeric chars or '_', got '%s'&quot;, identifierDesc, identifier);
<span class="fc" id="L239">    checkArgument(</span>
<span class="fc" id="L240">      DIGIT_CHAR_MATCHER.or(UNDERSCORE_CHAR_MATCHER).matchesNoneOf(identifier.subSequence(0, 1)),</span>
      &quot;%s must not start by a number or '_', got '%s'&quot;, identifierDesc, identifier);
<span class="fc bfc" id="L242" title="All 4 branches covered.">    checkArgument(!isSqlKeyword(identifier.toUpperCase(Locale.ENGLISH)) || ALLOWED_IDENTIFIERS.contains(identifier),</span>
      &quot;%s must not be an SQL reserved keyword, got '%s'&quot;,
      identifierDesc,
      identifier);
<span class="fc" id="L246">  }</span>

  private static void checkDbIdentifierCharactersIgnoreCase(String identifier, String identifierDesc) {
<span class="pc bpc" id="L249" title="1 of 2 branches missed.">    checkArgument(identifier.length() &gt; 0, &quot;Identifier must not be empty&quot;);</span>
<span class="fc" id="L250">    checkArgument(LOWER_CASE_ASCII_LETTERS_CHAR_MATCHER.or(DIGIT_CHAR_MATCHER).or(UPPER_CASE_ASCII_LETTERS_CHAR_MATCHER).or(anyOf(&quot;_&quot;)).matchesAllOf(identifier),</span>
      &quot;%s must contain only alphanumeric chars or '_', got '%s'&quot;, identifierDesc, identifier);
<span class="fc" id="L252">    checkArgument(</span>
<span class="fc" id="L253">      DIGIT_CHAR_MATCHER.or(UNDERSCORE_CHAR_MATCHER).matchesNoneOf(identifier.subSequence(0, 1)),</span>
      &quot;%s must not start by a number or '_', got '%s'&quot;, identifierDesc, identifier);
<span class="pc bpc" id="L255" title="1 of 4 branches missed.">    checkArgument(!isSqlKeywordIgnoreCase(identifier) || ALLOWED_IDENTIFIERS.contains(identifier.toLowerCase(Locale.ENGLISH)),</span>
      &quot;%s must not be an SQL reserved keyword, got '%s'&quot;,
      identifierDesc,
      identifier);
<span class="fc" id="L259">  }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>