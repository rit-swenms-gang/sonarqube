<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>SecurityStandards.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">sonarqube</a> &gt; <a href="index.source.html" class="el_package">org.sonar.server.security</a> &gt; <span class="el_source">SecurityStandards.java</span></div><h1>SecurityStandards.java</h1><pre class="source lang-java linenums">/*
 * SonarQube
 * Copyright (C) 2009-2025 SonarSource SA
 * mailto:info AT sonarsource DOT com
 *
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 3 of the License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with this program; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
 */
package org.sonar.server.security;

import com.google.common.collect.ImmutableMap;
import com.google.common.collect.Ordering;
import java.util.Arrays;
import java.util.Collection;
import java.util.Collections;
import java.util.HashMap;
import java.util.HashSet;
import java.util.List;
import java.util.Map;
import java.util.Objects;
import java.util.Optional;
import java.util.Set;
import java.util.function.Function;
import java.util.stream.Collectors;
import java.util.stream.IntStream;
import java.util.stream.Stream;
import javax.annotation.Nullable;
import javax.annotation.concurrent.Immutable;
import org.sonar.api.server.rule.RulesDefinition.OwaspAsvsVersion;
import org.sonar.api.server.rule.RulesDefinition.PciDssVersion;
import org.sonar.api.server.rule.RulesDefinition.StigVersion;

import static java.util.Arrays.asList;
import static java.util.Arrays.stream;
import static java.util.Collections.singleton;
import static java.util.Collections.singletonList;
import static org.sonar.api.server.rule.RulesDefinition.PciDssVersion.V3_2;
import static org.sonar.server.security.SecurityStandards.VulnerabilityProbability.HIGH;
import static org.sonar.server.security.SecurityStandards.VulnerabilityProbability.LOW;
import static org.sonar.server.security.SecurityStandards.VulnerabilityProbability.MEDIUM;

@Immutable
public final class SecurityStandards {

  public static final String UNKNOWN_STANDARD = &quot;unknown&quot;;

  /**
   * @deprecated SansTop25 report is outdated, it has been completely deprecated in version 10.0 and will be removed from version 11.0
   */
  @Deprecated(since = &quot;10.0&quot;, forRemoval = true)
  public static final String SANS_TOP_25_INSECURE_INTERACTION = &quot;insecure-interaction&quot;;
  @Deprecated(since = &quot;10.0&quot;, forRemoval = true)
  public static final String SANS_TOP_25_RISKY_RESOURCE = &quot;risky-resource&quot;;
  @Deprecated(since = &quot;10.0&quot;, forRemoval = true)
  public static final String SANS_TOP_25_POROUS_DEFENSES = &quot;porous-defenses&quot;;

  private static final String OWASP_MOBILE_TOP10_2024_PREFIX = &quot;owaspMobileTop10-2024:&quot;;
  private static final String OWASP_TOP10_PREFIX = &quot;owaspTop10:&quot;;
  private static final String OWASP_TOP10_2021_PREFIX = &quot;owaspTop10-2021:&quot;;
<span class="fc" id="L71">  private static final String PCI_DSS_32_PREFIX = V3_2.prefix() + &quot;:&quot;;</span>
<span class="fc" id="L72">  private static final String PCI_DSS_40_PREFIX = PciDssVersion.V4_0.prefix() + &quot;:&quot;;</span>
<span class="fc" id="L73">  private static final String OWASP_ASVS_40_PREFIX = OwaspAsvsVersion.V4_0.prefix() + &quot;:&quot;;</span>
  private static final String CWE_PREFIX = &quot;cwe:&quot;;
  // See https://www.sans.org/top25-software-errors

  /**
   * @deprecated SansTop25 report is outdated, it has been completely deprecated in version 10.0 and will be removed from version 11.0
   */
  @Deprecated(since = &quot;10.0&quot;, forRemoval = true)
<span class="fc" id="L81">  private static final Set&lt;String&gt; INSECURE_CWE = new HashSet&lt;&gt;(asList(&quot;89&quot;, &quot;78&quot;, &quot;79&quot;, &quot;434&quot;, &quot;352&quot;, &quot;601&quot;));</span>
  @Deprecated(since = &quot;10.0&quot;, forRemoval = true)
<span class="fc" id="L83">  private static final Set&lt;String&gt; RISKY_CWE = new HashSet&lt;&gt;(asList(&quot;120&quot;, &quot;22&quot;, &quot;494&quot;, &quot;829&quot;, &quot;676&quot;, &quot;131&quot;, &quot;134&quot;, &quot;190&quot;));</span>
  @Deprecated(since = &quot;10.0&quot;, forRemoval = true)
<span class="fc" id="L85">  private static final Set&lt;String&gt; POROUS_CWE = new HashSet&lt;&gt;(asList(&quot;306&quot;, &quot;862&quot;, &quot;798&quot;, &quot;311&quot;, &quot;807&quot;, &quot;250&quot;, &quot;863&quot;, &quot;732&quot;, &quot;327&quot;, &quot;307&quot;, &quot;759&quot;));</span>

  /**
   * @deprecated SansTop25 report is outdated, it has been completely deprecated in version 10.0 and will be removed from version 11.0
   */
  @Deprecated
<span class="fc" id="L91">  public static final Map&lt;String, Set&lt;String&gt;&gt; CWES_BY_SANS_TOP_25 = ImmutableMap.of(</span>
    SANS_TOP_25_INSECURE_INTERACTION, INSECURE_CWE,
    SANS_TOP_25_RISKY_RESOURCE, RISKY_CWE,
    SANS_TOP_25_POROUS_DEFENSES, POROUS_CWE);

  // https://cwe.mitre.org/top25/archive/2021/2021_cwe_top25.html
<span class="fc" id="L97">  public static final List&lt;String&gt; CWE_TOP25_2021 = List.of(&quot;787&quot;, &quot;79&quot;, &quot;125&quot;, &quot;20&quot;, &quot;78&quot;, &quot;89&quot;, &quot;416&quot;, &quot;22&quot;, &quot;352&quot;, &quot;434&quot;, &quot;306&quot;, &quot;190&quot;, &quot;502&quot;, &quot;287&quot;, &quot;476&quot;,</span>
    &quot;798&quot;, &quot;119&quot;, &quot;862&quot;, &quot;276&quot;, &quot;200&quot;, &quot;522&quot;, &quot;732&quot;, &quot;611&quot;, &quot;918&quot;, &quot;77&quot;);

  // https://cwe.mitre.org/top25/archive/2022/2022_cwe_top25.html
<span class="fc" id="L101">  public static final List&lt;String&gt; CWE_TOP25_2022 = List.of(&quot;787&quot;, &quot;79&quot;, &quot;89&quot;, &quot;20&quot;, &quot;125&quot;, &quot;78&quot;, &quot;416&quot;, &quot;22&quot;, &quot;352&quot;, &quot;434&quot;, &quot;476&quot;, &quot;502&quot;, &quot;190&quot;, &quot;287&quot;, &quot;798&quot;,</span>
    &quot;862&quot;, &quot;77&quot;, &quot;306&quot;, &quot;119&quot;, &quot;276&quot;, &quot;918&quot;, &quot;362&quot;, &quot;400&quot;, &quot;611&quot;, &quot;94&quot;);

  // https://cwe.mitre.org/top25/archive/2023/2023_top25_list.html#tableView
<span class="fc" id="L105">  public static final List&lt;String&gt; CWE_TOP25_2023 = List.of(&quot;787&quot;, &quot;79&quot;, &quot;89&quot;, &quot;416&quot;, &quot;78&quot;, &quot;20&quot;, &quot;125&quot;, &quot;22&quot;, &quot;352&quot;, &quot;434&quot;, &quot;862&quot;, &quot;476&quot;, &quot;287&quot;, &quot;190&quot;, &quot;502&quot;,</span>
    &quot;77&quot;, &quot;119&quot;, &quot;798&quot;, &quot;918&quot;, &quot;306&quot;, &quot;362&quot;, &quot;269&quot;, &quot;94&quot;, &quot;863&quot;, &quot;276&quot;);

  // https://cwe.mitre.org/top25/archive/2024/2024_cwe_top25.html#tableView
<span class="fc" id="L109">  public static final List&lt;String&gt; CWE_TOP25_2024 = List.of(&quot;79&quot;, &quot;787&quot;, &quot;89&quot;, &quot;352&quot;, &quot;22&quot;, &quot;125&quot;, &quot;78&quot;, &quot;416&quot;, &quot;862&quot;, &quot;434&quot;, &quot;94&quot;, &quot;20&quot;, &quot;77&quot;, &quot;287&quot;, &quot;269&quot;,</span>
    &quot;502&quot;, &quot;200&quot;, &quot;863&quot;, &quot;918&quot;, &quot;119&quot;, &quot;476&quot;, &quot;798&quot;, &quot;190&quot;, &quot;400&quot;, &quot;306&quot;);

  public static final String CWE_YEAR_2021 = &quot;2021&quot;;
  public static final String CWE_YEAR_2022 = &quot;2022&quot;;
  public static final String CWE_YEAR_2023 = &quot;2023&quot;;
  public static final String CWE_YEAR_2024 = &quot;2024&quot;;

<span class="fc" id="L117">  public static final Map&lt;String, List&lt;String&gt;&gt; CWES_BY_CWE_TOP_25 = Map.of(</span>
    CWE_YEAR_2021, CWE_TOP25_2021,
    CWE_YEAR_2022, CWE_TOP25_2022,
    CWE_YEAR_2023, CWE_TOP25_2023,
    CWE_YEAR_2024, CWE_TOP25_2024);

<span class="fc" id="L123">  private static final List&lt;String&gt; OWASP_ASVS_40_LEVEL_1 = List.of(&quot;2.1.1&quot;, &quot;2.1.10&quot;, &quot;2.1.11&quot;, &quot;2.1.12&quot;, &quot;2.1.2&quot;, &quot;2.1.3&quot;, &quot;2.1.4&quot;, &quot;2.1.5&quot;, &quot;2.1.6&quot;, &quot;2.1.7&quot;, &quot;2.1.8&quot;, &quot;2.1.9&quot;,</span>
    &quot;2.10.1&quot;, &quot;2.10.2&quot;, &quot;2.10.3&quot;, &quot;2.10.4&quot;, &quot;2.2.1&quot;, &quot;2.2.2&quot;, &quot;2.2.3&quot;, &quot;2.3.1&quot;, &quot;2.5.1&quot;, &quot;2.5.2&quot;, &quot;2.5.3&quot;, &quot;2.5.4&quot;, &quot;2.5.5&quot;, &quot;2.5.6&quot;, &quot;2.7.1&quot;, &quot;2.7.2&quot;, &quot;2.7.3&quot;, &quot;2.7.4&quot;, &quot;2.8.1&quot;,
    &quot;3.1.1&quot;, &quot;3.2.1&quot;, &quot;3.2.2&quot;, &quot;3.2.3&quot;, &quot;3.3.1&quot;, &quot;3.3.2&quot;, &quot;3.4.1&quot;, &quot;3.4.2&quot;, &quot;3.4.3&quot;, &quot;3.4.4&quot;, &quot;3.4.5&quot;, &quot;3.7.1&quot;, &quot;4.1.1&quot;, &quot;4.1.2&quot;, &quot;4.1.3&quot;, &quot;4.1.4&quot;, &quot;4.1.5&quot;, &quot;4.2.1&quot;, &quot;4.2.2&quot;,
    &quot;4.3.1&quot;, &quot;4.3.2&quot;, &quot;5.1.1&quot;, &quot;5.1.2&quot;, &quot;5.1.3&quot;, &quot;5.1.4&quot;, &quot;5.1.5&quot;, &quot;5.2.1&quot;, &quot;5.2.2&quot;, &quot;5.2.3&quot;, &quot;5.2.4&quot;, &quot;5.2.5&quot;, &quot;5.2.6&quot;, &quot;5.2.7&quot;, &quot;5.2.8&quot;, &quot;5.3.1&quot;, &quot;5.3.10&quot;, &quot;5.3.2&quot;, &quot;5.3.3&quot;,
    &quot;5.3.4&quot;, &quot;5.3.5&quot;, &quot;5.3.6&quot;, &quot;5.3.7&quot;, &quot;5.3.8&quot;, &quot;5.3.9&quot;, &quot;5.5.1&quot;, &quot;5.5.2&quot;, &quot;5.5.3&quot;, &quot;5.5.4&quot;, &quot;6.2.1&quot;, &quot;7.1.1&quot;, &quot;7.1.2&quot;, &quot;7.4.1&quot;, &quot;8.2.1&quot;, &quot;8.2.2&quot;, &quot;8.2.3&quot;, &quot;8.3.1&quot;, &quot;8.3.2&quot;,
    &quot;8.3.3&quot;, &quot;8.3.4&quot;, &quot;9.1.1&quot;, &quot;9.1.2&quot;, &quot;9.1.3&quot;, &quot;10.3.1&quot;, &quot;10.3.2&quot;, &quot;10.3.3&quot;, &quot;11.1.1&quot;, &quot;11.1.2&quot;, &quot;11.1.3&quot;, &quot;11.1.4&quot;, &quot;11.1.5&quot;, &quot;12.1.1&quot;, &quot;12.3.1&quot;, &quot;12.3.2&quot;, &quot;12.3.3&quot;, &quot;12.3.4&quot;,
    &quot;12.3.5&quot;, &quot;12.4.1&quot;, &quot;12.4.2&quot;, &quot;12.5.1&quot;, &quot;12.5.2&quot;, &quot;12.6.1&quot;, &quot;13.1.1&quot;, &quot;13.1.2&quot;, &quot;13.1.3&quot;, &quot;13.2.1&quot;, &quot;13.2.2&quot;, &quot;13.2.3&quot;, &quot;13.3.1&quot;, &quot;14.2.1&quot;, &quot;14.2.2&quot;, &quot;14.2.3&quot;, &quot;14.3.1&quot;,
    &quot;14.3.2&quot;, &quot;14.3.3&quot;, &quot;14.4.1&quot;, &quot;14.4.2&quot;, &quot;14.4.3&quot;, &quot;14.4.4&quot;, &quot;14.4.5&quot;, &quot;14.4.6&quot;, &quot;14.4.7&quot;, &quot;14.5.1&quot;, &quot;14.5.2&quot;, &quot;14.5.3&quot;);

<span class="fc" id="L132">  private static final List&lt;String&gt; OWASP_ASVS_40_LEVEL_2 = Stream.concat(Stream.of(&quot;1.1.1&quot;, &quot;1.1.2&quot;, &quot;1.1.3&quot;, &quot;1.1.4&quot;, &quot;1.1.5&quot;, &quot;1.1.6&quot;,</span>
    &quot;1.1.7&quot;, &quot;1.10.1&quot;, &quot;1.11.1&quot;, &quot;1.11.2&quot;, &quot;1.12.1&quot;, &quot;1.12.2&quot;, &quot;1.14.1&quot;, &quot;1.14.2&quot;, &quot;1.14.3&quot;, &quot;1.14.4&quot;, &quot;1.14.5&quot;, &quot;1.14.6&quot;, &quot;1.2.1&quot;, &quot;1.2.2&quot;, &quot;1.2.3&quot;, &quot;1.2.4&quot;, &quot;1.4.1&quot;, &quot;1.4.2&quot;,
    &quot;1.4.3&quot;, &quot;1.4.4&quot;, &quot;1.4.5&quot;, &quot;1.5.1&quot;, &quot;1.5.2&quot;, &quot;1.5.3&quot;, &quot;1.5.4&quot;, &quot;1.6.1&quot;, &quot;1.6.2&quot;, &quot;1.6.3&quot;, &quot;1.6.4&quot;, &quot;1.7.1&quot;, &quot;1.7.2&quot;, &quot;1.8.1&quot;, &quot;1.8.2&quot;, &quot;1.9.1&quot;, &quot;1.9.2&quot;, &quot;2.3.2&quot;, &quot;2.3.3&quot;,
    &quot;2.4.1&quot;, &quot;2.4.2&quot;, &quot;2.4.3&quot;, &quot;2.4.4&quot;, &quot;2.4.5&quot;, &quot;2.5.7&quot;, &quot;2.6.1&quot;, &quot;2.6.2&quot;, &quot;2.6.3&quot;, &quot;2.7.5&quot;, &quot;2.7.6&quot;, &quot;2.8.2&quot;, &quot;2.8.3&quot;, &quot;2.8.4&quot;, &quot;2.8.5&quot;, &quot;2.8.6&quot;, &quot;2.9.1&quot;, &quot;2.9.2&quot;, &quot;2.9.3&quot;,
    &quot;3.2.4&quot;, &quot;3.3.3&quot;, &quot;3.3.4&quot;, &quot;3.5.1&quot;, &quot;3.5.2&quot;, &quot;3.5.3&quot;, &quot;4.3.3&quot;, &quot;5.4.1&quot;, &quot;5.4.2&quot;, &quot;5.4.3&quot;, &quot;6.1.1&quot;, &quot;6.1.2&quot;, &quot;6.1.3&quot;, &quot;6.2.2&quot;, &quot;6.2.3&quot;, &quot;6.2.4&quot;, &quot;6.2.5&quot;, &quot;6.2.6&quot;, &quot;6.3.1&quot;,
    &quot;6.3.2&quot;, &quot;6.4.1&quot;, &quot;6.4.2&quot;, &quot;7.1.3&quot;, &quot;7.1.4&quot;, &quot;7.2.1&quot;, &quot;7.2.2&quot;, &quot;7.3.1&quot;, &quot;7.3.2&quot;, &quot;7.3.3&quot;, &quot;7.3.4&quot;, &quot;7.4.2&quot;, &quot;7.4.3&quot;, &quot;8.1.1&quot;, &quot;8.1.2&quot;, &quot;8.1.3&quot;, &quot;8.1.4&quot;, &quot;8.3.5&quot;, &quot;8.3.6&quot;,
    &quot;8.3.7&quot;, &quot;8.3.8&quot;, &quot;9.2.1&quot;, &quot;9.2.2&quot;, &quot;9.2.3&quot;, &quot;9.2.4&quot;, &quot;10.2.1&quot;, &quot;10.2.2&quot;, &quot;11.1.6&quot;, &quot;11.1.7&quot;, &quot;11.1.8&quot;, &quot;12.1.2&quot;, &quot;12.1.3&quot;, &quot;12.2.1&quot;, &quot;12.3.6&quot;, &quot;13.1.4&quot;, &quot;13.1.5&quot;, &quot;13.2.4&quot;,
<span class="fc" id="L139">    &quot;13.2.5&quot;, &quot;13.2.6&quot;, &quot;13.3.2&quot;, &quot;13.4.1&quot;, &quot;13.4.2&quot;, &quot;14.1.1&quot;, &quot;14.1.2&quot;, &quot;14.1.3&quot;, &quot;14.1.4&quot;, &quot;14.2.4&quot;, &quot;14.2.5&quot;, &quot;14.2.6&quot;, &quot;14.5.4&quot;), OWASP_ASVS_40_LEVEL_1.stream())</span>
<span class="fc" id="L140">    .toList();</span>

<span class="fc" id="L142">  private static final List&lt;String&gt; OWASP_ASVS_40_LEVEL_3 = Stream</span>
<span class="fc" id="L143">    .concat(Stream.of(&quot;1.11.3&quot;, &quot;2.2.4&quot;, &quot;2.2.5&quot;, &quot;2.2.6&quot;, &quot;2.2.7&quot;, &quot;2.8.7&quot;, &quot;3.6.1&quot;, &quot;3.6.2&quot;, &quot;6.2.7&quot;, &quot;6.2.8&quot;, &quot;6.3.3&quot;, &quot;8.1.5&quot;,</span>
<span class="fc" id="L144">      &quot;8.1.6&quot;, &quot;9.2.5&quot;, &quot;10.1.1&quot;, &quot;10.2.3&quot;, &quot;10.2.4&quot;, &quot;10.2.5&quot;, &quot;10.2.6&quot;, &quot;14.1.5&quot;), OWASP_ASVS_40_LEVEL_2.stream())</span>
<span class="fc" id="L145">    .toList();</span>

<span class="fc" id="L147">  public static final Map&lt;Integer, List&lt;String&gt;&gt; OWASP_ASVS_40_REQUIREMENTS_BY_LEVEL = Map.of(</span>
<span class="fc" id="L148">    1, OWASP_ASVS_40_LEVEL_1,</span>
<span class="fc" id="L149">    2, OWASP_ASVS_40_LEVEL_2,</span>
<span class="fc" id="L150">    3, OWASP_ASVS_40_LEVEL_3);</span>

<span class="fc" id="L152">  public static final Map&lt;OwaspAsvsVersion, Map&lt;Integer, List&lt;String&gt;&gt;&gt; OWASP_ASVS_REQUIREMENTS_BY_LEVEL = Map.of(</span>
    OwaspAsvsVersion.V4_0, OWASP_ASVS_40_REQUIREMENTS_BY_LEVEL);

<span class="fc" id="L155">  public enum VulnerabilityProbability {</span>
<span class="fc" id="L156">    HIGH(3),</span>
<span class="fc" id="L157">    MEDIUM(2),</span>
<span class="fc" id="L158">    LOW(1);</span>

    private final int score;

<span class="fc" id="L162">    VulnerabilityProbability(int index) {</span>
<span class="fc" id="L163">      this.score = index;</span>
<span class="fc" id="L164">    }</span>

    public int getScore() {
<span class="fc" id="L167">      return score;</span>
    }

    public static Optional&lt;VulnerabilityProbability&gt; byScore(@Nullable Integer score) {
<span class="pc bpc" id="L171" title="1 of 2 branches missed.">      if (score == null) {</span>
<span class="nc" id="L172">        return Optional.empty();</span>
      }
<span class="fc" id="L174">      return Arrays.stream(values())</span>
<span class="fc bfc" id="L175" title="All 2 branches covered.">        .filter(t -&gt; t.score == score)</span>
<span class="fc" id="L176">        .findFirst();</span>
    }
  }

<span class="fc" id="L180">  public enum SQCategory {</span>
<span class="fc" id="L181">    BUFFER_OVERFLOW(&quot;buffer-overflow&quot;, HIGH),</span>
<span class="fc" id="L182">    SQL_INJECTION(&quot;sql-injection&quot;, HIGH),</span>
<span class="fc" id="L183">    RCE(&quot;rce&quot;, MEDIUM),</span>
<span class="fc" id="L184">    OBJECT_INJECTION(&quot;object-injection&quot;, LOW),</span>
<span class="fc" id="L185">    COMMAND_INJECTION(&quot;command-injection&quot;, HIGH),</span>
<span class="fc" id="L186">    PATH_TRAVERSAL_INJECTION(&quot;path-traversal-injection&quot;, HIGH),</span>
<span class="fc" id="L187">    LDAP_INJECTION(&quot;ldap-injection&quot;, LOW),</span>
<span class="fc" id="L188">    XPATH_INJECTION(&quot;xpath-injection&quot;, LOW),</span>
<span class="fc" id="L189">    LOG_INJECTION(&quot;log-injection&quot;, LOW),</span>
<span class="fc" id="L190">    XXE(&quot;xxe&quot;, MEDIUM),</span>
<span class="fc" id="L191">    XSS(&quot;xss&quot;, HIGH),</span>
<span class="fc" id="L192">    DOS(&quot;dos&quot;, MEDIUM),</span>
<span class="fc" id="L193">    SSRF(&quot;ssrf&quot;, MEDIUM),</span>
<span class="fc" id="L194">    CSRF(&quot;csrf&quot;, HIGH),</span>
<span class="fc" id="L195">    HTTP_RESPONSE_SPLITTING(&quot;http-response-splitting&quot;, LOW),</span>
<span class="fc" id="L196">    OPEN_REDIRECT(&quot;open-redirect&quot;, MEDIUM),</span>
<span class="fc" id="L197">    WEAK_CRYPTOGRAPHY(&quot;weak-cryptography&quot;, MEDIUM),</span>
<span class="fc" id="L198">    AUTH(&quot;auth&quot;, HIGH),</span>
<span class="fc" id="L199">    INSECURE_CONF(&quot;insecure-conf&quot;, LOW),</span>
<span class="fc" id="L200">    FILE_MANIPULATION(&quot;file-manipulation&quot;, LOW),</span>
<span class="fc" id="L201">    ENCRYPTION_OF_SENSITIVE_DATA(&quot;encrypt-data&quot;, LOW),</span>
<span class="fc" id="L202">    TRACEABILITY(&quot;traceability&quot;, LOW),</span>
<span class="fc" id="L203">    PERMISSION(&quot;permission&quot;, MEDIUM),</span>
<span class="fc" id="L204">    OTHERS(&quot;others&quot;, LOW);</span>

<span class="fc" id="L206">    private static final Map&lt;String, SQCategory&gt; SQ_CATEGORY_BY_KEY = stream(values()).collect(Collectors.toMap(SQCategory::getKey, Function.identity()));</span>
    private final String key;
    private final VulnerabilityProbability vulnerability;

<span class="fc" id="L210">    SQCategory(String key, VulnerabilityProbability vulnerability) {</span>
<span class="fc" id="L211">      this.key = key;</span>
<span class="fc" id="L212">      this.vulnerability = vulnerability;</span>
<span class="fc" id="L213">    }</span>

    public String getKey() {
<span class="fc" id="L216">      return key;</span>
    }

    public VulnerabilityProbability getVulnerability() {
<span class="fc" id="L220">      return vulnerability;</span>
    }

    public static Optional&lt;SQCategory&gt; fromKey(@Nullable String key) {
<span class="fc" id="L224">      return Optional.ofNullable(key).map(SQ_CATEGORY_BY_KEY::get);</span>
    }
  }

<span class="fc" id="L228">  public enum StigSupportedRequirement {</span>
<span class="fc" id="L229">    V222612(&quot;V-222612&quot;),</span>
<span class="fc" id="L230">    V222578(&quot;V-222578&quot;),</span>
<span class="fc" id="L231">    V222577(&quot;V-222577&quot;),</span>
<span class="fc" id="L232">    V222609(&quot;V-222609&quot;),</span>
<span class="fc" id="L233">    V222608(&quot;V-222608&quot;),</span>
<span class="fc" id="L234">    V222602(&quot;V-222602&quot;),</span>
<span class="fc" id="L235">    V222607(&quot;V-222607&quot;),</span>
<span class="fc" id="L236">    V222604(&quot;V-222604&quot;),</span>
<span class="fc" id="L237">    V222550(&quot;V-222550&quot;),</span>
<span class="fc" id="L238">    V222596(&quot;V-222596&quot;),</span>
<span class="fc" id="L239">    V222620(&quot;V-222620&quot;),</span>
<span class="fc" id="L240">    V222542(&quot;V-222542&quot;),</span>
<span class="fc" id="L241">    V222642(&quot;V-222642&quot;),</span>
<span class="fc" id="L242">    V222567(&quot;V-222567&quot;),</span>
<span class="fc" id="L243">    V222618(&quot;V-222618&quot;),</span>
<span class="fc" id="L244">    V222610(&quot;V-222610&quot;),</span>
<span class="fc" id="L245">    V222579(&quot;V-222579&quot;),</span>
<span class="fc" id="L246">    V222615(&quot;V-222615&quot;),</span>
<span class="fc" id="L247">    V222575(&quot;V-222575&quot;),</span>
<span class="fc" id="L248">    V222576(&quot;V-222576&quot;),</span>
<span class="fc" id="L249">    V222562(&quot;V-222562&quot;),</span>
<span class="fc" id="L250">    V222563(&quot;V-222563&quot;),</span>
<span class="fc" id="L251">    V222603(&quot;V-222603&quot;),</span>
<span class="fc" id="L252">    V222606(&quot;V-222606&quot;),</span>
<span class="fc" id="L253">    V222605(&quot;V-222605&quot;),</span>
<span class="fc" id="L254">    V222391(&quot;V-222391&quot;),</span>
<span class="fc" id="L255">    V222588(&quot;V-222588&quot;),</span>
<span class="fc" id="L256">    V222582(&quot;V-222582&quot;),</span>
<span class="fc" id="L257">    V222519(&quot;V-222519&quot;),</span>
<span class="fc" id="L258">    V222599(&quot;V-222599&quot;),</span>
<span class="fc" id="L259">    V222593(&quot;V-222593&quot;),</span>
<span class="fc" id="L260">    V222597(&quot;V-222597&quot;),</span>
<span class="fc" id="L261">    V222594(&quot;V-222594&quot;),</span>
<span class="fc" id="L262">    V222397(&quot;V-222397&quot;),</span>
<span class="fc" id="L263">    V222534(&quot;V-222534&quot;),</span>
<span class="fc" id="L264">    V222641(&quot;V-222641&quot;),</span>
<span class="fc" id="L265">    V222598(&quot;V-222598&quot;),</span>
<span class="fc" id="L266">    V254803(&quot;V-254803&quot;),</span>
<span class="fc" id="L267">    V222667(&quot;V-222667&quot;),</span>
<span class="fc" id="L268">    V222653(&quot;V-222653&quot;),</span>
<span class="fc" id="L269">    V222649(&quot;V-222649&quot;);</span>

    private final String requirement;

<span class="fc" id="L273">    StigSupportedRequirement(String requirement) {</span>

<span class="fc" id="L275">      this.requirement = requirement;</span>
<span class="fc" id="L276">    }</span>

    public String getRequirement() {
<span class="fc" id="L279">      return requirement;</span>
    }
  }

<span class="fc" id="L283">  public enum PciDss {</span>
<span class="fc" id="L284">    R1(&quot;1&quot;), R2(&quot;2&quot;), R3(&quot;3&quot;), R4(&quot;4&quot;), R5(&quot;5&quot;), R6(&quot;6&quot;), R7(&quot;7&quot;), R8(&quot;8&quot;), R9(&quot;9&quot;), R10(&quot;10&quot;), R11(&quot;11&quot;), R12(&quot;12&quot;);</span>

    private final String category;

<span class="fc" id="L288">    PciDss(String category) {</span>
<span class="fc" id="L289">      this.category = category;</span>
<span class="fc" id="L290">    }</span>

    public String category() {
<span class="fc" id="L293">      return category;</span>
    }
  }

<span class="fc" id="L297">  public enum OwaspAsvs {</span>
<span class="fc" id="L298">    C1(&quot;1&quot;), C2(&quot;2&quot;), C3(&quot;3&quot;), C4(&quot;4&quot;), C5(&quot;5&quot;), C6(&quot;6&quot;), C7(&quot;7&quot;), C8(&quot;8&quot;), C9(&quot;9&quot;), C10(&quot;10&quot;), C11(&quot;11&quot;), C12(&quot;12&quot;), C13(&quot;13&quot;), C14(&quot;14&quot;);</span>

    private final String category;

<span class="fc" id="L302">    OwaspAsvs(String category) {</span>
<span class="fc" id="L303">      this.category = category;</span>
<span class="fc" id="L304">    }</span>

    public String category() {
<span class="fc" id="L307">      return category;</span>
    }
  }

<span class="fc" id="L311">  public static final Map&lt;SQCategory, Set&lt;String&gt;&gt; CWES_BY_SQ_CATEGORY = ImmutableMap.&lt;SQCategory, Set&lt;String&gt;&gt;builder()</span>
<span class="fc" id="L312">    .put(SQCategory.BUFFER_OVERFLOW, Set.of(&quot;119&quot;, &quot;120&quot;, &quot;131&quot;, &quot;676&quot;, &quot;788&quot;))</span>
<span class="fc" id="L313">    .put(SQCategory.SQL_INJECTION, Set.of(&quot;89&quot;, &quot;564&quot;, &quot;943&quot;))</span>
<span class="fc" id="L314">    .put(SQCategory.COMMAND_INJECTION, Set.of(&quot;77&quot;, &quot;78&quot;, &quot;88&quot;, &quot;214&quot;))</span>
<span class="fc" id="L315">    .put(SQCategory.PATH_TRAVERSAL_INJECTION, Set.of(&quot;22&quot;))</span>
<span class="fc" id="L316">    .put(SQCategory.LDAP_INJECTION, Set.of(&quot;90&quot;))</span>
<span class="fc" id="L317">    .put(SQCategory.XPATH_INJECTION, Set.of(&quot;643&quot;))</span>
<span class="fc" id="L318">    .put(SQCategory.RCE, Set.of(&quot;94&quot;, &quot;95&quot;))</span>
<span class="fc" id="L319">    .put(SQCategory.DOS, Set.of(&quot;400&quot;, &quot;624&quot;))</span>
<span class="fc" id="L320">    .put(SQCategory.SSRF, Set.of(&quot;918&quot;))</span>
<span class="fc" id="L321">    .put(SQCategory.CSRF, Set.of(&quot;352&quot;))</span>
<span class="fc" id="L322">    .put(SQCategory.XSS, Set.of(&quot;79&quot;, &quot;80&quot;, &quot;81&quot;, &quot;82&quot;, &quot;83&quot;, &quot;84&quot;, &quot;85&quot;, &quot;86&quot;, &quot;87&quot;))</span>
<span class="fc" id="L323">    .put(SQCategory.LOG_INJECTION, Set.of(&quot;117&quot;))</span>
<span class="fc" id="L324">    .put(SQCategory.HTTP_RESPONSE_SPLITTING, Set.of(&quot;113&quot;))</span>
<span class="fc" id="L325">    .put(SQCategory.OPEN_REDIRECT, Set.of(&quot;601&quot;))</span>
<span class="fc" id="L326">    .put(SQCategory.XXE, Set.of(&quot;611&quot;, &quot;827&quot;))</span>
<span class="fc" id="L327">    .put(SQCategory.OBJECT_INJECTION, Set.of(&quot;134&quot;, &quot;470&quot;, &quot;502&quot;))</span>
<span class="fc" id="L328">    .put(SQCategory.WEAK_CRYPTOGRAPHY, Set.of(&quot;295&quot;, &quot;297&quot;, &quot;321&quot;, &quot;322&quot;, &quot;323&quot;, &quot;324&quot;, &quot;325&quot;, &quot;326&quot;, &quot;327&quot;, &quot;328&quot;, &quot;330&quot;, &quot;780&quot;))</span>
<span class="fc" id="L329">    .put(SQCategory.AUTH, Set.of(&quot;798&quot;, &quot;640&quot;, &quot;620&quot;, &quot;549&quot;, &quot;522&quot;, &quot;521&quot;, &quot;263&quot;, &quot;262&quot;, &quot;261&quot;, &quot;259&quot;, &quot;308&quot;))</span>
<span class="fc" id="L330">    .put(SQCategory.INSECURE_CONF, Set.of(&quot;102&quot;, &quot;215&quot;, &quot;346&quot;, &quot;614&quot;, &quot;489&quot;, &quot;942&quot;))</span>
<span class="fc" id="L331">    .put(SQCategory.FILE_MANIPULATION, Set.of(&quot;97&quot;, &quot;73&quot;))</span>
<span class="fc" id="L332">    .put(SQCategory.ENCRYPTION_OF_SENSITIVE_DATA, Set.of(&quot;311&quot;, &quot;315&quot;, &quot;319&quot;))</span>
<span class="fc" id="L333">    .put(SQCategory.TRACEABILITY, Set.of(&quot;778&quot;))</span>
<span class="fc" id="L334">    .put(SQCategory.PERMISSION, Set.of(&quot;266&quot;, &quot;269&quot;, &quot;284&quot;, &quot;668&quot;, &quot;732&quot;))</span>
<span class="fc" id="L335">    .build();</span>
<span class="fc" id="L336">  private static final Ordering&lt;SQCategory&gt; SQ_CATEGORY_ORDERING = Ordering.explicit(stream(SQCategory.values()).toList());</span>
<span class="fc" id="L337">  public static final Ordering&lt;String&gt; SQ_CATEGORY_KEYS_ORDERING = Ordering.explicit(stream(SQCategory.values()).map(SQCategory::getKey).toList());</span>

  public static final Map&lt;String, String&gt; CWES_BY_CASA_CATEGORY;

  static {
<span class="fc" id="L342">    Map&lt;String, String&gt; map = new HashMap&lt;&gt;();</span>
<span class="fc" id="L343">    map.put(&quot;1.1.4&quot;, &quot;1059&quot;);</span>
<span class="fc" id="L344">    map.put(&quot;1.14.6&quot;, &quot;477&quot;);</span>
<span class="fc" id="L345">    map.put(&quot;1.4.1&quot;, &quot;602&quot;);</span>
<span class="fc" id="L346">    map.put(&quot;1.8.1&quot;, null);</span>
<span class="fc" id="L347">    map.put(&quot;1.8.2&quot;, null);</span>
<span class="fc" id="L348">    map.put(&quot;2.1.1&quot;, &quot;521&quot;);</span>
<span class="fc" id="L349">    map.put(&quot;2.3.1&quot;, &quot;330&quot;);</span>
<span class="fc" id="L350">    map.put(&quot;2.4.1&quot;, &quot;916&quot;);</span>
<span class="fc" id="L351">    map.put(&quot;2.5.4&quot;, &quot;16&quot;);</span>
<span class="fc" id="L352">    map.put(&quot;2.6.1&quot;, &quot;308&quot;);</span>
<span class="fc" id="L353">    map.put(&quot;2.7.2&quot;, &quot;287&quot;);</span>
<span class="fc" id="L354">    map.put(&quot;2.7.6&quot;, &quot;310&quot;);</span>
<span class="fc" id="L355">    map.put(&quot;3.3.1&quot;, &quot;613&quot;);</span>
<span class="fc" id="L356">    map.put(&quot;3.3.3&quot;, &quot;613&quot;);</span>
<span class="fc" id="L357">    map.put(&quot;3.4.1&quot;, &quot;614&quot;);</span>
<span class="fc" id="L358">    map.put(&quot;3.4.2&quot;, &quot;1004&quot;);</span>
<span class="fc" id="L359">    map.put(&quot;3.4.3&quot;, &quot;1275&quot;);</span>
<span class="fc" id="L360">    map.put(&quot;3.5.2&quot;, &quot;798&quot;);</span>
<span class="fc" id="L361">    map.put(&quot;3.5.3&quot;, &quot;345&quot;);</span>
<span class="fc" id="L362">    map.put(&quot;3.7.1&quot;, &quot;306&quot;);</span>
<span class="fc" id="L363">    map.put(&quot;4.1.1&quot;, &quot;602&quot;);</span>
<span class="fc" id="L364">    map.put(&quot;4.1.2&quot;, &quot;639&quot;);</span>
<span class="fc" id="L365">    map.put(&quot;4.1.3&quot;, &quot;285&quot;);</span>
<span class="fc" id="L366">    map.put(&quot;4.1.5&quot;, &quot;285&quot;);</span>
<span class="fc" id="L367">    map.put(&quot;4.2.1&quot;, &quot;639&quot;);</span>
<span class="fc" id="L368">    map.put(&quot;4.2.2&quot;, &quot;352&quot;);</span>
<span class="fc" id="L369">    map.put(&quot;4.3.1&quot;, &quot;419&quot;);</span>
<span class="fc" id="L370">    map.put(&quot;4.3.2&quot;, &quot;548&quot;);</span>
<span class="fc" id="L371">    map.put(&quot;5.1.1&quot;, &quot;235&quot;);</span>
<span class="fc" id="L372">    map.put(&quot;5.1.5&quot;, &quot;601&quot;);</span>
<span class="fc" id="L373">    map.put(&quot;5.2.3&quot;, &quot;147&quot;);</span>
<span class="fc" id="L374">    map.put(&quot;5.2.4&quot;, &quot;95&quot;);</span>
<span class="fc" id="L375">    map.put(&quot;5.2.5&quot;, &quot;94&quot;);</span>
<span class="fc" id="L376">    map.put(&quot;5.2.6&quot;, &quot;918&quot;);</span>
<span class="fc" id="L377">    map.put(&quot;5.2.7&quot;, &quot;159&quot;);</span>
<span class="fc" id="L378">    map.put(&quot;5.3.1&quot;, &quot;116&quot;);</span>
<span class="fc" id="L379">    map.put(&quot;5.3.10&quot;, &quot;643&quot;);</span>
<span class="fc" id="L380">    map.put(&quot;5.3.3&quot;, &quot;79&quot;);</span>
<span class="fc" id="L381">    map.put(&quot;5.3.4&quot;, &quot;89&quot;);</span>
<span class="fc" id="L382">    map.put(&quot;5.3.6&quot;, &quot;830&quot;);</span>
<span class="fc" id="L383">    map.put(&quot;5.3.7&quot;, &quot;90&quot;);</span>
<span class="fc" id="L384">    map.put(&quot;5.3.8&quot;, &quot;78&quot;);</span>
<span class="fc" id="L385">    map.put(&quot;5.3.9&quot;, &quot;829&quot;);</span>
<span class="fc" id="L386">    map.put(&quot;5.5.2&quot;, &quot;611&quot;);</span>
<span class="fc" id="L387">    map.put(&quot;6.1.1&quot;, &quot;311&quot;);</span>
<span class="fc" id="L388">    map.put(&quot;6.2.1&quot;, &quot;310&quot;);</span>
<span class="fc" id="L389">    map.put(&quot;6.2.3&quot;, &quot;326&quot;);</span>
<span class="fc" id="L390">    map.put(&quot;6.2.4&quot;, &quot;326&quot;);</span>
<span class="fc" id="L391">    map.put(&quot;6.2.7&quot;, &quot;326&quot;);</span>
<span class="fc" id="L392">    map.put(&quot;6.2.8&quot;, &quot;385&quot;);</span>
<span class="fc" id="L393">    map.put(&quot;6.3.2&quot;, &quot;338&quot;);</span>
<span class="fc" id="L394">    map.put(&quot;6.4.2&quot;, &quot;320&quot;);</span>
<span class="fc" id="L395">    map.put(&quot;7.1.1&quot;, &quot;532&quot;);</span>
<span class="fc" id="L396">    map.put(&quot;8.1.1&quot;, &quot;524&quot;);</span>
<span class="fc" id="L397">    map.put(&quot;8.2.2&quot;, &quot;922&quot;);</span>
<span class="fc" id="L398">    map.put(&quot;8.3.1&quot;, &quot;319&quot;);</span>
<span class="fc" id="L399">    map.put(&quot;8.3.5&quot;, &quot;532&quot;);</span>
<span class="fc" id="L400">    map.put(&quot;9.1.2&quot;, &quot;326&quot;);</span>
<span class="fc" id="L401">    map.put(&quot;9.2.1&quot;, &quot;295&quot;);</span>
<span class="fc" id="L402">    map.put(&quot;9.2.4&quot;, &quot;299&quot;);</span>
<span class="fc" id="L403">    map.put(&quot;10.3.2&quot;, &quot;353&quot;);</span>
<span class="fc" id="L404">    map.put(&quot;10.3.3&quot;, &quot;350&quot;);</span>
<span class="fc" id="L405">    map.put(&quot;11.1.4&quot;, &quot;770&quot;);</span>
<span class="fc" id="L406">    map.put(&quot;12.4.1&quot;, &quot;552&quot;);</span>
<span class="fc" id="L407">    map.put(&quot;12.4.2&quot;, &quot;509&quot;);</span>
<span class="fc" id="L408">    map.put(&quot;13.1.3&quot;, &quot;598&quot;);</span>
<span class="fc" id="L409">    map.put(&quot;13.1.4&quot;, &quot;285&quot;);</span>
<span class="fc" id="L410">    map.put(&quot;13.2.1&quot;, &quot;650&quot;);</span>
<span class="fc" id="L411">    map.put(&quot;14.1.1&quot;, null);</span>
<span class="fc" id="L412">    map.put(&quot;14.1.4&quot;, null);</span>
<span class="fc" id="L413">    map.put(&quot;14.1.5&quot;, null);</span>
<span class="fc" id="L414">    map.put(&quot;14.3.2&quot;, &quot;497&quot;);</span>
<span class="fc" id="L415">    map.put(&quot;14.5.2&quot;, &quot;346&quot;);</span>
<span class="fc" id="L416">    CWES_BY_CASA_CATEGORY = Collections.unmodifiableMap(map);</span>
  }

<span class="fc" id="L419">  public static final List&lt;String&gt; CASA_ROOT_CATEGORIES =</span>
<span class="fc" id="L420">    IntStream.rangeClosed(1, 14).mapToObj(String::valueOf).collect(Collectors.toUnmodifiableList());</span>

  private final Set&lt;String&gt; standards;
  private final Set&lt;String&gt; cwe;
  private final Set&lt;String&gt; casaCategories;
  private final SQCategory sqCategory;
  private final Set&lt;SQCategory&gt; ignoredSQCategories;

  private SecurityStandards(Set&lt;String&gt; standards, Set&lt;String&gt; cwe, Set&lt;String&gt; casaCategories,
<span class="fc" id="L429">    SQCategory sqCategory, Set&lt;SQCategory&gt; ignoredSQCategories) {</span>
<span class="fc" id="L430">    this.standards = standards;</span>
<span class="fc" id="L431">    this.cwe = cwe;</span>
<span class="fc" id="L432">    this.casaCategories = casaCategories;</span>
<span class="fc" id="L433">    this.sqCategory = sqCategory;</span>
<span class="fc" id="L434">    this.ignoredSQCategories = ignoredSQCategories;</span>
<span class="fc" id="L435">  }</span>

  public Set&lt;String&gt; getStandards() {
<span class="fc" id="L438">    return standards;</span>
  }

  public Set&lt;String&gt; getCwe() {
<span class="fc" id="L442">    return cwe;</span>
  }

  public Set&lt;String&gt; getPciDss32() {
<span class="fc" id="L446">    return getMatchingStandards(standards, PCI_DSS_32_PREFIX);</span>
  }

  public Set&lt;String&gt; getPciDss40() {
<span class="fc" id="L450">    return getMatchingStandards(standards, PCI_DSS_40_PREFIX);</span>
  }

  public Set&lt;String&gt; getOwaspAsvs40() {
<span class="fc" id="L454">    return getMatchingStandards(standards, OWASP_ASVS_40_PREFIX);</span>
  }

  public Set&lt;String&gt; getOwaspMobileTop10For2024() {
<span class="fc" id="L458">    return getMatchingStandards(standards, OWASP_MOBILE_TOP10_2024_PREFIX);</span>
  }

  public Set&lt;String&gt; getOwaspTop10() {
<span class="fc" id="L462">    return getMatchingStandards(standards, OWASP_TOP10_PREFIX);</span>
  }

  public Set&lt;String&gt; getOwaspTop10For2021() {
<span class="fc" id="L466">    return getMatchingStandards(standards, OWASP_TOP10_2021_PREFIX);</span>
  }

  public Set&lt;String&gt; getStig(StigVersion version) {
<span class="fc" id="L470">    return getMatchingStandards(standards, version.prefix() + &quot;:&quot;);</span>
  }

  public Set&lt;String&gt; getCasa() {
<span class="fc" id="L474">    return casaCategories;</span>
  }

  /**
   * @deprecated SansTop25 report is outdated, it has been completely deprecated in version 10.0 and will be removed from version 11.0
   */
  @Deprecated
  public Set&lt;String&gt; getSansTop25() {
<span class="fc" id="L482">    return toSansTop25(cwe);</span>
  }

  public Set&lt;String&gt; getCweTop25() {
<span class="fc" id="L486">    return toCweTop25(cwe);</span>
  }

  public SQCategory getSqCategory() {
<span class="fc" id="L490">    return sqCategory;</span>
  }

  /**
   * If CWEs mapped to multiple {@link SQCategory}, those which are not taken into account are listed here.
   */
  public Set&lt;SQCategory&gt; getIgnoredSQCategories() {
<span class="fc" id="L497">    return ignoredSQCategories;</span>
  }

  /**
   * @throws IllegalStateException if {@code securityStandards} maps to multiple {@link SQCategory SQCategories}
   */
  public static SecurityStandards fromSecurityStandards(Set&lt;String&gt; securityStandards) {
<span class="fc" id="L504">    Set&lt;String&gt; standards = securityStandards.stream().filter(Objects::nonNull).collect(Collectors.toSet());</span>
<span class="fc" id="L505">    Set&lt;String&gt; cwe = toCwes(standards);</span>
<span class="fc" id="L506">    List&lt;SQCategory&gt; sq = toSortedSQCategories(cwe);</span>
<span class="fc" id="L507">    SQCategory sqCategory = sq.iterator().next();</span>
<span class="fc" id="L508">    Set&lt;SQCategory&gt; ignoredSQCategories = sq.stream().skip(1).collect(Collectors.toSet());</span>
<span class="fc" id="L509">    Set&lt;String&gt; casaCategories = toCasaCategories(cwe);</span>
<span class="fc" id="L510">    return new SecurityStandards(standards, cwe, casaCategories, sqCategory, ignoredSQCategories);</span>
  }

  public static Set&lt;String&gt; getRequirementsForCategoryAndLevel(String category, int level) {
<span class="fc" id="L514">    return OWASP_ASVS_40_REQUIREMENTS_BY_LEVEL.get(level).stream()</span>
<span class="fc" id="L515">      .filter(req -&gt; req.startsWith(category + &quot;.&quot;))</span>
<span class="fc" id="L516">      .collect(Collectors.toSet());</span>
  }

  public static Set&lt;String&gt; getRequirementsForCategoryAndLevel(OwaspAsvs category, int level) {
<span class="fc" id="L520">    return getRequirementsForCategoryAndLevel(category.category(), level);</span>
  }

  private static Set&lt;String&gt; getMatchingStandards(Set&lt;String&gt; securityStandards, String prefix) {
<span class="fc" id="L524">    return securityStandards.stream()</span>
<span class="fc" id="L525">      .filter(s -&gt; s.startsWith(prefix))</span>
<span class="fc" id="L526">      .map(s -&gt; s.substring(prefix.length()))</span>
<span class="fc" id="L527">      .collect(Collectors.toSet());</span>
  }

  private static Set&lt;String&gt; toCwes(Collection&lt;String&gt; securityStandards) {
<span class="fc" id="L531">    Set&lt;String&gt; result = securityStandards.stream()</span>
<span class="fc" id="L532">      .filter(s -&gt; s.startsWith(CWE_PREFIX))</span>
<span class="fc" id="L533">      .map(s -&gt; s.substring(CWE_PREFIX.length()))</span>
<span class="fc" id="L534">      .collect(Collectors.toSet());</span>
<span class="fc bfc" id="L535" title="All 2 branches covered.">    return result.isEmpty() ? singleton(UNKNOWN_STANDARD) : result;</span>
  }

  private static Set&lt;String&gt; toCweTop25(Set&lt;String&gt; cwe) {
<span class="fc" id="L539">    return CWES_BY_CWE_TOP_25</span>
<span class="fc" id="L540">      .keySet()</span>
<span class="fc" id="L541">      .stream()</span>
<span class="fc" id="L542">      .filter(k -&gt; cwe.stream().anyMatch(CWES_BY_CWE_TOP_25.get(k)::contains))</span>
<span class="fc" id="L543">      .collect(Collectors.toSet());</span>
  }

  private static Set&lt;String&gt; toSansTop25(Collection&lt;String&gt; cwe) {
<span class="fc" id="L547">    return CWES_BY_SANS_TOP_25</span>
<span class="fc" id="L548">      .keySet()</span>
<span class="fc" id="L549">      .stream()</span>
<span class="fc" id="L550">      .filter(k -&gt; cwe.stream().anyMatch(CWES_BY_SANS_TOP_25.get(k)::contains))</span>
<span class="fc" id="L551">      .collect(Collectors.toSet());</span>
  }

  private static List&lt;SQCategory&gt; toSortedSQCategories(Collection&lt;String&gt; cwe) {
<span class="fc" id="L555">    List&lt;SQCategory&gt; result = CWES_BY_SQ_CATEGORY</span>
<span class="fc" id="L556">      .keySet()</span>
<span class="fc" id="L557">      .stream()</span>
<span class="fc" id="L558">      .filter(k -&gt; cwe.stream().anyMatch(CWES_BY_SQ_CATEGORY.get(k)::contains))</span>
<span class="fc" id="L559">      .sorted(SQ_CATEGORY_ORDERING)</span>
<span class="fc" id="L560">      .toList();</span>
<span class="fc bfc" id="L561" title="All 2 branches covered.">    return result.isEmpty() ? singletonList(SQCategory.OTHERS) : result;</span>
  }

  private static Set&lt;String&gt; toCasaCategories(Set&lt;String&gt; cwe) {
<span class="fc" id="L565">    return CWES_BY_CASA_CATEGORY</span>
<span class="fc" id="L566">      .keySet()</span>
<span class="fc" id="L567">      .stream()</span>
<span class="fc" id="L568">      .filter(k -&gt; cwe.contains(CWES_BY_CASA_CATEGORY.get(k)))</span>
<span class="fc" id="L569">      .collect(Collectors.toSet());</span>
  }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>